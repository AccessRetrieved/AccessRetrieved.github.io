"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3473,9321],{39570:function(e,t,r){r.d(t,{F:function(){return f},M:function(){return n}});const n={Base64:0,Hex:1,String:2,Raw:3};function i(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function s(e){const t=[];for(let r=0,n=8*e.length;r<n;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}function o(e){const t=[];for(let r=0,n=32*e.length;r<n;r+=8)t.push(String.fromCharCode(e[r>>5]>>>r%32&255));return t.join("")}function a(e,t,r,n,s,o){return i(function(e,t){return e<<t|e>>>32-t}(i(i(t,e),i(n,o)),s),r)}function u(e,t,r,n,i,s,o){return a(t&r|~t&n,e,t,i,s,o)}function l(e,t,r,n,i,s,o){return a(t&n|r&~n,e,t,i,s,o)}function c(e,t,r,n,i,s,o){return a(t^r^n,e,t,i,s,o)}function p(e,t,r,n,i,s,o){return a(r^(t|~n),e,t,i,s,o)}function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let r=1732584193,n=-271733879,s=-1732584194,o=271733878;for(let a=0;a<e.length;a+=16){const t=r,d=n,f=s,y=o;r=u(r,n,s,o,e[a],7,-680876936),o=u(o,r,n,s,e[a+1],12,-389564586),s=u(s,o,r,n,e[a+2],17,606105819),n=u(n,s,o,r,e[a+3],22,-1044525330),r=u(r,n,s,o,e[a+4],7,-176418897),o=u(o,r,n,s,e[a+5],12,1200080426),s=u(s,o,r,n,e[a+6],17,-1473231341),n=u(n,s,o,r,e[a+7],22,-45705983),r=u(r,n,s,o,e[a+8],7,1770035416),o=u(o,r,n,s,e[a+9],12,-1958414417),s=u(s,o,r,n,e[a+10],17,-42063),n=u(n,s,o,r,e[a+11],22,-1990404162),r=u(r,n,s,o,e[a+12],7,1804603682),o=u(o,r,n,s,e[a+13],12,-40341101),s=u(s,o,r,n,e[a+14],17,-1502002290),n=u(n,s,o,r,e[a+15],22,1236535329),r=l(r,n,s,o,e[a+1],5,-165796510),o=l(o,r,n,s,e[a+6],9,-1069501632),s=l(s,o,r,n,e[a+11],14,643717713),n=l(n,s,o,r,e[a],20,-373897302),r=l(r,n,s,o,e[a+5],5,-701558691),o=l(o,r,n,s,e[a+10],9,38016083),s=l(s,o,r,n,e[a+15],14,-660478335),n=l(n,s,o,r,e[a+4],20,-405537848),r=l(r,n,s,o,e[a+9],5,568446438),o=l(o,r,n,s,e[a+14],9,-1019803690),s=l(s,o,r,n,e[a+3],14,-187363961),n=l(n,s,o,r,e[a+8],20,1163531501),r=l(r,n,s,o,e[a+13],5,-1444681467),o=l(o,r,n,s,e[a+2],9,-51403784),s=l(s,o,r,n,e[a+7],14,1735328473),n=l(n,s,o,r,e[a+12],20,-1926607734),r=c(r,n,s,o,e[a+5],4,-378558),o=c(o,r,n,s,e[a+8],11,-2022574463),s=c(s,o,r,n,e[a+11],16,1839030562),n=c(n,s,o,r,e[a+14],23,-35309556),r=c(r,n,s,o,e[a+1],4,-1530992060),o=c(o,r,n,s,e[a+4],11,1272893353),s=c(s,o,r,n,e[a+7],16,-155497632),n=c(n,s,o,r,e[a+10],23,-1094730640),r=c(r,n,s,o,e[a+13],4,681279174),o=c(o,r,n,s,e[a],11,-358537222),s=c(s,o,r,n,e[a+3],16,-722521979),n=c(n,s,o,r,e[a+6],23,76029189),r=c(r,n,s,o,e[a+9],4,-640364487),o=c(o,r,n,s,e[a+12],11,-421815835),s=c(s,o,r,n,e[a+15],16,530742520),n=c(n,s,o,r,e[a+2],23,-995338651),r=p(r,n,s,o,e[a],6,-198630844),o=p(o,r,n,s,e[a+7],10,1126891415),s=p(s,o,r,n,e[a+14],15,-1416354905),n=p(n,s,o,r,e[a+5],21,-57434055),r=p(r,n,s,o,e[a+12],6,1700485571),o=p(o,r,n,s,e[a+3],10,-1894986606),s=p(s,o,r,n,e[a+10],15,-1051523),n=p(n,s,o,r,e[a+1],21,-2054922799),r=p(r,n,s,o,e[a+8],6,1873313359),o=p(o,r,n,s,e[a+15],10,-30611744),s=p(s,o,r,n,e[a+6],15,-1560198380),n=p(n,s,o,r,e[a+13],21,1309151649),r=p(r,n,s,o,e[a+4],6,-145523070),o=p(o,r,n,s,e[a+11],10,-1120210379),s=p(s,o,r,n,e[a+2],15,718787259),n=p(n,s,o,r,e[a+9],21,-343485551),r=i(r,t),n=i(n,d),s=i(s,f),o=i(o,y)}return[r,n,s,o]}function f(e,t=n.Hex){const r=t||n.Base64,i=d(s(e),8*e.length);switch(r){case n.Raw:return i;case n.Hex:return function(e){const t="0123456789abcdef",r=[];for(let n=0,i=4*e.length;n<i;n++)r.push(t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15));return r.join("")}(i);case n.String:return o(i);case n.Base64:return function(e){const t=[];for(let r=0,n=4*e.length;r<n;r+=3){const n=(e[r>>2]>>r%4*8&255)<<16|(e[r+1>>2]>>(r+1)%4*8&255)<<8|e[r+2>>2]>>(r+2)%4*8&255;for(let i=0;i<4;i++)8*r+6*i>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-i)&63))}return t.join("")}(i)}}},86113:function(e,t,r){r.d(t,{M:function(){return M}});var n,i=r(19353),s=r(44569),o=(r(72325),r(24431),r(79285),r(3968)),a=r(97927),u=r(60211),l=r(80982),c=(r(17655),r(71869),r(18109),r(12402),r(72410),r(38523),r(51540)),p=(r(88187),r(87213)),d=r(69999),f=r(970),y=r(17733),h=r(32855),m=r(70588),b=r(30357),w=r(56415),v=r(8808),g=r(65627);let _=n=class extends u.B{constructor(e){super(e),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(e,t,r){const n=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,y.RB)(r,n,t)}readRenderer(e,t,r){const n=t.drawingInfo?.renderer;return n?(0,p.a)(n,t,r)??void 0:(0,v.Ob)(t,r)}clone(){return new n({fields:(0,f.d9)(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:(0,f.d9)(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:(0,f.d9)(this.popupTemplate),renderer:(0,f.d9)(this.renderer)})}};(0,i._)([(0,h.J)({binning:"binning"})],_.prototype,"type",void 0),(0,i._)([(0,h.J)({geohash:"geohash"})],_.prototype,"binType",void 0),(0,i._)([(0,s.Cb)({type:Number,range:{min:1,max:9},json:{write:!0}})],_.prototype,"fixedBinLevel",void 0),(0,i._)([(0,s.Cb)({type:[g.Z],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],_.prototype,"labelingInfo",void 0),(0,i._)([(0,s.Cb)(w.iR)],_.prototype,"labelsVisible",void 0),(0,i._)([(0,s.Cb)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],_.prototype,"maxScale",void 0),(0,i._)([(0,s.Cb)(w.C_)],_.prototype,"popupEnabled",void 0),(0,i._)([(0,s.Cb)({type:l.Z,json:{name:"popupInfo",write:!0}})],_.prototype,"popupTemplate",void 0),(0,i._)([(0,s.Cb)({type:[a.Z],json:{write:!0}})],_.prototype,"fields",void 0),(0,i._)([(0,b.c)("fields")],_.prototype,"writeFields",null),(0,i._)([(0,s.Cb)({types:d.A,json:{write:{target:"drawingInfo.renderer"}}})],_.prototype,"renderer",void 0),(0,i._)([(0,m.r)("renderer",["drawingInfo.renderer"])],_.prototype,"readRenderer",null),_=n=(0,i._)([(0,o.j)("esri.layers.support.FeatureReductionBinning")],_);const x=_;var S,C=r(74497),F=r(90791),j=r(81397);function I(e){return"simple"===e.type&&!e.visualVariables?.length}let Z=S=class extends F.wq{constructor(e){super(e),this.type="cluster",this.clusterRadius=(0,j.t_)("80px"),this.clusterMinSize=(0,j.t_)("12px"),this.clusterMaxSize=(0,j.t_)("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}readRenderer(e,t,r){const n=t.drawingInfo?.renderer;return n?.authoringInfo?.isAutoGenerated?null:n?I(n)?null:(0,p.a)(n,t,r)??void 0:(0,v.Ob)(t,r)}readSymbol(e,t,r){const n=t.drawingInfo?.renderer;if(n?.authoringInfo?.isAutoGenerated)return null;if(n&&I(n)){return(0,p.a)(n,t,r)?.symbol}return null}writeSymbol(e,t,r,n){const i=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||i){const r=new c.Z({symbol:e});t.drawingInfo={renderer:r.write({},n)}}}writeFields(e,t,r){const n=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,y.RB)(r,n,t)}readFields(e,t,r){return e.filter((e=>!e.isAutoGenerated)).map((e=>a.Z.fromJSON(e)))}clone(){return new S({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:(0,f.d9)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:(0,f.d9)(this.fields),maxScale:this.maxScale,renderer:(0,f.d9)(this.renderer),symbol:(0,f.d9)(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:(0,f.d9)(this.popupTemplate)})}};(0,i._)([(0,s.Cb)({type:["cluster"],readOnly:!0,json:{write:!0}})],Z.prototype,"type",void 0),(0,i._)([(0,s.Cb)({type:Number,cast:e=>"auto"===e?e:(0,j.t_)(e),json:{write:!0}})],Z.prototype,"clusterRadius",void 0),(0,i._)([(0,s.Cb)({type:Number,cast:j.t_,json:{write:!0}})],Z.prototype,"clusterMinSize",void 0),(0,i._)([(0,s.Cb)({type:Number,cast:j.t_,json:{write:!0}})],Z.prototype,"clusterMaxSize",void 0),(0,i._)([(0,s.Cb)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Z.prototype,"maxScale",void 0),(0,i._)([(0,s.Cb)(w.C_)],Z.prototype,"popupEnabled",void 0),(0,i._)([(0,s.Cb)({type:l.Z,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Z.prototype,"popupTemplate",void 0),(0,i._)([(0,s.Cb)({types:d.A,json:{write:{target:"drawingInfo.renderer"}}})],Z.prototype,"renderer",void 0),(0,i._)([(0,m.r)("renderer",["drawingInfo.renderer"])],Z.prototype,"readRenderer",null),(0,i._)([(0,s.Cb)({types:C.AH})],Z.prototype,"symbol",void 0),(0,i._)([(0,m.r)("symbol",["drawingInfo.renderer"])],Z.prototype,"readSymbol",null),(0,i._)([(0,b.c)("symbol")],Z.prototype,"writeSymbol",null),(0,i._)([(0,s.Cb)({type:[g.Z],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Z.prototype,"labelingInfo",void 0),(0,i._)([(0,s.Cb)(w.iR)],Z.prototype,"labelsVisible",void 0),(0,i._)([(0,s.Cb)({type:[a.Z],json:{write:!0}})],Z.prototype,"fields",void 0),(0,i._)([(0,b.c)("fields")],Z.prototype,"writeFields",null),(0,i._)([(0,m.r)("fields")],Z.prototype,"readFields",null),Z=S=(0,i._)([(0,o.j)("esri.layers.support.FeatureReductionCluster")],Z);const E=Z;var R=r(85454);const A={key:"type",base:u.B,typeMap:{cluster:E,binning:x}},V={types:{key:"type",base:u.B,typeMap:{selection:R.Z,cluster:E,binning:x}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:A},"portal-item":{types:A},"web-scene":{types:{key:"type",base:u.B,typeMap:{selection:R.Z}}}}}};var z=r(63244);const M=e=>{let t=class extends e{constructor(...e){super(...e),this.own(this.watch("renderer",(()=>{if(this.featureReduction){const e=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",e)}}),!0))}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}set renderer(e){}_normalizeFeatureReduction(e){if("cluster"!==e?.type)return e;const t=e.clone(),r=[new a.Z({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],n=(t.fields??[]).filter((e=>!e.isAutoGenerated));if(e.renderer&&!e.renderer.authoringInfo?.isAutoGenerated)return t.fields=[...r,...n],t;if(e.symbol)return t.fields=[...r,...n],t.renderer=null,t;if(!this.renderer)return e;const i=(0,z.S1)(r,this.renderer,e,null,!1);return t.fields=[...r,...n],t.renderer=i,t}};return(0,i._)([(0,s.Cb)(V)],t.prototype,"featureReduction",null),t=(0,i._)([(0,o.j)("esri.layers.mixins.FeatureReductionLayer")],t),t}},97927:function(e,t,r){r.d(t,{Z:function(){return p}});var n,i=r(19353),s=r(90791),o=r(970),a=r(44569),u=(r(72325),r(3968)),l=r(78362);let c=n=class extends s.wq{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new n({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:(0,o.d9)(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};(0,i._)([(0,a.Cb)({type:Boolean,json:{write:!0}})],c.prototype,"isAutoGenerated",void 0),(0,i._)([(0,a.Cb)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,i._)([(0,a.Cb)({type:String,json:{write:!0}})],c.prototype,"alias",void 0),(0,i._)([(0,a.Cb)({type:String,json:{write:!0}})],c.prototype,"onStatisticField",void 0),(0,i._)([(0,a.Cb)({type:l.Z,json:{write:!0}})],c.prototype,"onStatisticExpression",void 0),(0,i._)([(0,a.Cb)({type:String,json:{write:!0}})],c.prototype,"statisticType",void 0),c=n=(0,i._)([(0,u.j)("esri.layers.support.AggregateField")],c);const p=c},78362:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(19353),i=r(22956),s=r(90791),o=r(44569),a=(r(72325),r(24431),r(79285),r(3968));let u=class extends((0,i.J)(s.wq)){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};(0,n._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"expression",void 0),(0,n._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"title",void 0),(0,n._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"returnType",void 0),u=(0,n._)([(0,a.j)("esri.layers.support.ExpressionInfo")],u);const l=u},60211:function(e,t,r){r.d(t,{B:function(){return a}});var n=r(19353),i=r(90791),s=r(44569),o=(r(72325),r(24431),r(79285),r(3968));let a=class extends i.wq{constructor(){super(...arguments),this.type=null}};(0,n._)([(0,s.Cb)({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],a.prototype,"type",void 0),a=(0,n._)([(0,o.j)("esri.layers.support.FeatureReduction")],a)},85454:function(e,t,r){r.d(t,{Z:function(){return l}});var n,i=r(19353),s=r(44569),o=(r(72325),r(24431),r(79285),r(3968)),a=r(60211);let u=n=class extends a.B{constructor(e){super(e),this.type="selection"}clone(){return new n}};(0,i._)([(0,s.Cb)({type:["selection"]})],u.prototype,"type",void 0),u=n=(0,i._)([(0,o.j)("esri.layers.support.FeatureReductionSelection")],u);const l=u},8808:function(e,t,r){r.d(t,{C9:function(){return Z},Ci:function(){return x},FV:function(){return _},Fr:function(){return h},JD:function(){return m},JY:function(){return z},Jj:function(){return v},KE:function(){return j},Ob:function(){return G},SU:function(){return S},VG:function(){return F},Y5:function(){return w},gG:function(){return E},kZ:function(){return V},kp:function(){return I},nU:function(){return O},rP:function(){return R},rk:function(){return A},sX:function(){return T},tD:function(){return C},uj:function(){return g}});var n=r(69788),i=r(74497),s=r(60346),o=r(76871),a=r(19295),u=r(85167),l=r(70949),c=r(51540),p=r(88187),d=r(36242),f=r(29034),y=r(9321);const h=new o.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function m(e,t,r,n){const i=await M(e);if(await b(e,t,n),!i.addAttachment)throw new s.Z(n,"Layer source does not support addAttachment capability");return i.addAttachment(t,r)}function b(e,t,r){const{attributes:n}=t,{objectIdField:i}=e;return e.get("capabilities.data.supportsAttachment")?t?n?i&&n[i]?Promise.resolve():Promise.reject(new s.Z(r,`feature is missing the identifying attribute ${i}`)):Promise.reject(new s.Z(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new s.Z(r,"A feature is required to add/delete/update attachments")):Promise.reject(new s.Z(r,"this layer doesn't support attachments"))}async function w(e,t,r,n,i){const o=await M(e);if(await b(e,t,i),!o.updateAttachment)throw new s.Z(i,"Layer source does not support updateAttachment capability");return o.updateAttachment(t,r,n)}async function v(e,t,n){const{applyEdits:i}=await r.e(75142).then(r.bind(r,75142)),s=await e.load();return i(s,s.source,t,n)}async function g(e,t,n){const{uploadAssets:i}=await r.e(75142).then(r.bind(r,75142)),s=await e.load();return i(s,s.source,t,n)}async function _(e,t,r,n){const i=await M(e);if(await b(e,t,n),!i.deleteAttachments)throw new s.Z(n,"Layer source does not support deleteAttachments capability");return i.deleteAttachments(t,r)}async function x(e,t,r){const n=(await e.load({signal:t?.signal})).source;if(!n.fetchRecomputedExtents)throw new s.Z(r,"Layer source does not support fetchUpdates capability");return n.fetchRecomputedExtents(t)}async function S(e,t,r,n){t=d.Z.from(t),await e.load();const i=e.source,o=e.capabilities;if(!o?.data?.supportsAttachment)throw new s.Z(n,"this layer doesn't support attachments");const{attachmentTypes:a,objectIds:u,globalIds:l,num:c,size:p,start:f,where:y}=t;if(!o?.operations?.supportsQueryAttachments&&(a?.length>0||l?.length>0||p?.length>0||c||f||y))throw new s.Z(n,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",t);if(!(u?.length||l?.length||y))throw new s.Z(n,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",t);if(!i.queryAttachments)throw new s.Z(n,"Layer source does not support queryAttachments capability",t);return i.queryAttachments(t)}async function C(e,t,r,n){const i=await M(e);if(!i.queryObjectIds)throw new s.Z(n,"Layer source does not support queryObjectIds capability");return i.queryObjectIds(f.Z.from(t)??e.createQuery(),r)}async function F(e,t,r,n){const i=await M(e);if(!i.queryFeatureCount)throw new s.Z(n,"Layer source does not support queryFeatureCount capability");return i.queryFeatureCount(f.Z.from(t)??e.createQuery(),r)}async function j(e,t,r,n){const i=await M(e);if(!i.queryExtent)throw new s.Z(n,"Layer source does not support queryExtent capability");return i.queryExtent(f.Z.from(t)??e.createQuery(),r)}async function I(e,t,r,n){const i=await M(e);if(!i.queryRelatedFeatures)throw new s.Z(n,"Layer source does not support queryRelatedFeatures capability");return i.queryRelatedFeatures(y.default.from(t),r)}async function Z(e,t,r,n){const i=await M(e);if(!i.queryRelatedFeaturesCount)throw new s.Z(n,"Layer source does not support queryRelatedFeaturesCount capability");return i.queryRelatedFeaturesCount(y.default.from(t),r)}async function E(e){const t=e.source;if(t?.refresh)try{const{dataChanged:r,updates:n}=await t.refresh();if(null!=n&&(e.sourceJSON={...e.sourceJSON,...n},e.read(n,{origin:"service",url:e.parsedUrl})),r)return!0}catch{}if(e.definitionExpression)try{return(await(0,a.E)(e.definitionExpression,e.fieldsIndex)).hasDateFunctions}catch{}return!1}function R(e){const t=new f.Z,r=e.get("capabilities.data"),n=e.get("capabilities.query");t.historicMoment=e.historicMoment,t.gdbVersion=e.gdbVersion,t.returnGeometry=!0,n&&(t.compactGeometryEnabled=n.supportsCompactGeometry,t.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference),r&&(r.supportsZ&&null!=e.returnZ&&(t.returnZ=e.returnZ),r.supportsM&&null!=e.returnM&&(t.returnM=e.returnM)),t.outFields=["*"];const{timeOffset:i,timeExtent:s}=e;return t.timeExtent=null!=i&&null!=s?s.offset(-i.value,i.unit):s||null,t.multipatchOption="multipatch"===e.geometryType?"xyFootprint":null,t}function A(e){const{globalIdField:t,fields:r}=e;if(t)return t;if(r)for(const n of r)if("esriFieldTypeGlobalID"===n.type)return n.name}function V(e){const{objectIdField:t,fields:r}=e;if(t)return t;if(r)for(const n of r)if("esriFieldTypeOID"===n.type)return n.name}function z(e){return e.currentVersion?e.currentVersion:e.hasOwnProperty("capabilities")||e.hasOwnProperty("drawingInfo")||e.hasOwnProperty("hasAttachments")||e.hasOwnProperty("htmlPopupType")||e.hasOwnProperty("relationships")||e.hasOwnProperty("timeInfo")||e.hasOwnProperty("typeIdField")||e.hasOwnProperty("types")?10:9.3}async function M(e){return(await e.load()).source}async function O(e,t){const r=e.parsedUrl?.path;r&&function(e){const t=e.editFieldsInfo;return!(!t?.creatorField&&!t?.editorField)||(e.userHasUpdateItemPrivileges?e.hasUpdateItemRestrictions:!!e.userHasFullEditingPrivileges&&e.hasFullEditingRestrictions)}(e)&&await async function(e,t){if(!n.id)return;if(n.id.findCredential(e))return;let r;try{const i=await(0,l.oP)(e,t);i&&(r=await n.id.checkSignInStatus(`${i}/sharing`))}catch(i){}if(r)try{const r=null!=t?t.signal:null;await n.id.getCredential(e,{signal:r})}catch(i){}}(r,t)}function T(e){return!e.sourceJSON?.isMultiServicesView&&(e.userHasUpdateItemPrivileges||e.editingEnabled)}const q=(0,u.d)({types:i.QT});function G(e,t){if(e.defaultSymbol)return e.types&&e.types.length?new p.Z({defaultSymbol:q(e.defaultSymbol,e,t),field:e.typeIdField,uniqueValueInfos:e.types.map((e=>({id:e.id,symbol:q(e.symbol,e,t)})))}):new c.Z({symbol:q(e.defaultSymbol,e,t)})}},76827:function(e,t,r){r.d(t,{v:function(){return a}});var n=r(44817),i=r(6057),s=r(73523),o=r(47503);function a(){return{fields:{type:[i.Z],value:null},fieldsIndex:{readOnly:!0,get(){return new s.Z(this.fields||[])}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){const e=this._userOutFields;if(!e||!e.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const t of e){const r=this.fieldsIndex?.has(t);r||n.Z.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${t} found in outFields`,{layer:this,outFields:e})}return(0,o.Q0)(this.fieldsIndex,e)}}}}},9321:function(e,t,r){r.r(t),r.d(t,{default:function(){return y}});var n,i=r(19353),s=(r(70799),r(90791)),o=r(970),a=r(44569),u=r(72325),l=r(3968),c=r(30357),p=r(13155),d=r(13681);let f=n=class extends s.wq{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(t.definitionExpression="1=1")}clone(){return new n((0,o.d9)({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};(0,i._)([(0,a.Cb)({type:Boolean,json:{write:!0}})],f.prototype,"cacheHint",void 0),(0,i._)([(0,a.Cb)({type:p.n,json:{write:!0}})],f.prototype,"dynamicDataSource",void 0),(0,i._)([(0,a.Cb)({type:String,json:{write:!0}})],f.prototype,"gdbVersion",void 0),(0,i._)([(0,a.Cb)({type:Number,json:{write:!0}})],f.prototype,"geometryPrecision",void 0),(0,i._)([(0,a.Cb)({type:Date})],f.prototype,"historicMoment",void 0),(0,i._)([(0,c.c)("historicMoment")],f.prototype,"_writeHistoricMoment",null),(0,i._)([(0,a.Cb)({type:Number,json:{write:!0}})],f.prototype,"maxAllowableOffset",void 0),(0,i._)([(0,a.Cb)({type:[Number],json:{write:!0}})],f.prototype,"objectIds",void 0),(0,i._)([(0,a.Cb)({type:[String],json:{write:!0}})],f.prototype,"orderByFields",void 0),(0,i._)([(0,a.Cb)({type:[String],json:{write:!0}})],f.prototype,"outFields",void 0),(0,i._)([(0,a.Cb)({type:d.Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],f.prototype,"outSpatialReference",void 0),(0,i._)([(0,a.Cb)({json:{write:!0}})],f.prototype,"relationshipId",void 0),(0,i._)([(0,a.Cb)({type:Number,json:{read:{source:"resultOffset"}}})],f.prototype,"start",void 0),(0,i._)([(0,c.c)("start"),(0,c.c)("num")],f.prototype,"writeStart",null),(0,i._)([(0,a.Cb)({type:Number,json:{read:{source:"resultRecordCount"}}})],f.prototype,"num",void 0),(0,i._)([(0,a.Cb)({json:{write:!0}})],f.prototype,"returnGeometry",void 0),(0,i._)([(0,a.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],f.prototype,"returnM",void 0),(0,i._)([(0,a.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],f.prototype,"returnZ",void 0),(0,i._)([(0,a.Cb)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],f.prototype,"where",void 0),f=n=(0,i._)([(0,l.j)("esri.rest.support.RelationshipQuery")],f),f.from=(0,u.se)(f);const y=f},63244:function(e,t,r){r.d(t,{aV:function(){return j},S1:function(){return x},os:function(){return S},st:function(){return C},yR:function(){return I}});var n,i=r(60346),s=r(79285),o=r(44817),a=r(39570),u=r(97927),l=r(78362),c=r(18278),p=r(96985),d=r(38069),f=r(19353),y=r(970),h=r(44569),m=(r(72325),r(3968)),b=r(30357),w=r(1802);let v=n=class extends p.Z{writeLevels(e,t,r){for(const n in e){const e=this.levels[n];return void(t.stops=e)}}clone(){return new n({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,w.iY)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,w.iY)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:(0,y.d9)(this.levels)})}};(0,f._)([(0,h.Cb)()],v.prototype,"levels",void 0),(0,f._)([(0,b.c)("levels")],v.prototype,"writeLevels",null),v=n=(0,f._)([(0,m.j)("esri.views.2d.engine.LevelDependentSizeVariable")],v);const g=o.Z.getLogger("esri.views.2d.layers.support.clusterUtils");s.Z.add("esri-cluster-arcade-enabled",!0);const _=(0,s.Z)("esri-cluster-arcade-enabled"),x=(e,t,r,n,i)=>{const s=t.clone();if(!I(s))return s;if(s.authoringInfo||(s.authoringInfo=new c.Z),s.authoringInfo.isAutoGenerated=!0,"visualVariables"in s){const t=(s.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression)),o=S(t);t.forEach((t=>{"rotation"===t.type?t.field?t.field=E(e,t.field,"avg_angle","number"):t.valueExpression&&(t.field=Z(e,t.valueExpression,"avg_angle","number"),t.valueExpression=null):t.normalizationField?(t.field=E(e,t.field,"avg_norm","number",t.normalizationField),t.normalizationField=null):t.field?t.field=E(e,t.field,"avg","number"):t.valueExpression&&(t.field=Z(e,t.valueExpression,"avg","number"),t.valueExpression=null)})),null==o&&!F(t)&&i&&(t.push(j(r,n)),s.dynamicClusterSize=!0),s.visualVariables=t}switch(s.type){case"simple":break;case"pie-chart":for(const t of s.attributes)t.field?t.field=E(e,t.field,"sum","number"):t.valueExpression&&(t.field=Z(e,t.valueExpression,"sum","number"),t.valueExpression=null);break;case"unique-value":s.field?s.field=E(e,s.field,"mode","string"):s.valueExpression&&(s.field=Z(e,s.valueExpression,"mode","string"),s.valueExpression=null);break;case"class-breaks":s.normalizationField?(s.field=E(e,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=E(e,s.field,"avg","number"):s.valueExpression&&(s.field=Z(e,s.valueExpression,"avg","number"),s.valueExpression=null)}return s},S=e=>{for(const t of e)if("size"===t.type)return t;return null};function C(e,t,r){const n=e.clone();let i=!1;if("visualVariables"in n){const e=(n.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression));null==S(e)&&(n.visualVariables||(n.visualVariables=[]),n.visualVariables.push(j(t,r)),n.dynamicClusterSize=!0,i=!0)}return{renderer:n,didInject:i}}const F=e=>{for(const t of e)if("cluster_count"===t.field)return!0;return!1},j=(e,t)=>{const r=[new d.Z({value:0,size:0}),new d.Z({value:1})];if(null==t)return new p.Z({field:"cluster_count",stops:[...r,new d.Z({value:2,size:0})]});const n=Object.keys(t).reduce(((n,i)=>({...n,[i]:[...r,new d.Z({value:Math.max(2,t[i].minValue),size:e.clusterMinSize}),new d.Z({value:Math.max(3,t[i].maxValue),size:e.clusterMaxSize})]})),{});return new v({field:"cluster_count",levels:n})},I=e=>{const t=t=>g.error(new i.Z("Unsupported-renderer",t,{renderer:e}));if(!e)return!1;switch(e.type){case"unique-value":if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(e.normalizationField){const r=e.normalizationType;if("field"!==r)return t(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}break;case"simple":case"pie-chart":break;default:return t(`FeatureReductionCluster does not support renderers of type ${e.type}`),!1}if(!_){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((e=>!(!("valueExpression"in e)||!e.valueExpression))))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function Z(e,t,r,n){const i=(0,a.F)(t),s="mode"===r?`cluster_type_${i}`:"sum"===r?`cluster_sum_${i}`:`cluster_avg_${i}`;return e.some((e=>e.name===s))||e.push(new u.Z({name:s,isAutoGenerated:!0,onStatisticExpression:new l.Z({expression:t,returnType:n}),statisticType:r})),s}function E(e,t,r,n,i){if("cluster_count"===t||e.some((e=>e.name===t)))return t;const s=function(e,t,r){switch(e){case"sum":return`cluster_sum_${t}`;case"avg":case"avg_angle":return`cluster_avg_${t}`;case"mode":return`cluster_type_${t}`;case"avg_norm":{const e=r,n="field",i=t.toLowerCase()+",norm:"+n+","+e.toLowerCase();return"cluster_avg_"+(0,a.F)(i)}}}(r,t,i);return e.some((e=>e.name===s))||("avg_norm"===r?e.push(new u.Z({name:s,isAutoGenerated:!0,onStatisticExpression:new l.Z({expression:`$feature.${t} / $feature.${i}`,returnType:n}),statisticType:"avg"})):e.push(new u.Z({name:s,isAutoGenerated:!0,onStatisticField:t,statisticType:r}))),s}}}]);