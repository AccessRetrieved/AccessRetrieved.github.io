"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87017],{62778:function(e,t,i){i.d(t,{I:function(){return s}});const s="M12 16a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1zM5 1h7v1H5zm0 2h7v9H5zm0 10h7v2H9v-1H8v1H5z"},55542:function(e,t,i){i.d(t,{G:function(){return s}});const s="M15.167 13a.834.834 0 0 0 .833-.834V1.834A.834.834 0 0 0 15.167 1H.833A.834.834 0 0 0 0 1.833v10.334A.834.834 0 0 0 .833 13H6v1H5v1h6v-1h-1v-1zM1 2h14v10H1zm8 12H7v-1h2z"},66974:function(e,t,i){i.d(t,{M:function(){return s}});const s="M22.719 12A10.719 10.719 0 0 1 1.28 12h.838a9.916 9.916 0 1 0 1.373-5H8v1H2V2h1v4.2A10.71 10.71 0 0 1 22.719 12z"},24059:function(e,t,i){i.d(t,{$q:function(){return v},IF:function(){return g},K3:function(){return y},s7:function(){return w}});var s=i(2784),o=i(83112),a=i(81736),r=i(63789),n=i(4628),l=i(4479),d=i(36871),p=i(45530),c=i(80979),h=i(24378),u=i(93564),m=i(43544);const g=e=>{(0,s.useEffect)((()=>{(0,a.Mq)(e)}),[e])},f=e=>{const t=(0,s.useRef)();return{initialThemeItemInfo:e??t.current,setInitialThemeItemInfo:(0,s.useCallback)((e=>{t.current=e}),[])}},y=e=>{let{isOrgItem:t,isEmbedded:i,headerQuery:o,itemType:a}=e;const n=(0,c.Z)(!0),l=(0,s.useMemo)((()=>!t||a===r.o.Briefing||!(i&&"true"!==o&&""!==o||"false"===o)),[t,i,o,a]);return!!n&&l},x=(0,h.e)(),v=(e,t)=>{const{id:i,itemDetails:o,publishedData:a,setLocaleFromPage:r,query:l,config:p,signInUrl:c,authManager:h,storyMapUserPrivileges:g}=t,[y,v]=(0,s.useState)(!x),w=(e=>{let{itemType:t,version:i,viewerMode:o,id:a,itemDetails:r,versionedItemData:l,authManager:d,storyMapUserPrivileges:p,config:c}=e;const h=new n.ZP({type:t,authManager:d,version:i,getStoryMapUserPrivileges:()=>p,viewerMode:o,config:c});return a&&(h.itemId=a),r&&(h.itemDetails=r),l&&(h.itemData=l),(0,s.useRef)(h).current})({itemType:e,version:"published",viewerMode:"view",authManager:h,storyMapUserPrivileges:g,config:p,...y?{id:i,itemDetails:o,versionedItemData:a}:{}}),{initialThemeItemInfo:b,setInitialThemeItemInfo:I}=f(t.initialThemeItemInfo);return(0,s.useEffect)((()=>{let t=!1;return(async()=>{try{if(!y){var i;const s=await(0,u.A)({id:null===(i=l)||void 0===i?void 0:i.id,config:p,signInUrl:c,authManager:h,itemType:e,shouldRedirect:!0,convertRoute:m.Q});if(t||!s.success)return;const{id:o,itemDetails:a,publishedData:n,pageLocale:d,initialThemeItemInfo:g}=s;w.itemId=o,w.itemDetails=a,w.itemData=n,I(g),await r({pageLocale:d}),v(!0)}}catch(s){v((()=>{if(s instanceof d.Z)throw new d.Z(s);throw new Error(s)}))}})(),()=>{t=!0}}),[w,I,y,e,r,l,p,c,h]),{isReady:y,storyItem:w,initialThemeItemInfo:b}},w=(e,t)=>{var i,a;const{id:r,itemDetails:n,draftData:c,locale:h,setLocaleFromPage:g,query:y,config:v,signInUrl:w,authManager:b,storyMapUserPrivileges:I}=t,{formatMessage:T}=(0,o.Z)(),S=(null===(i=y)||void 0===i?void 0:i.id)===p.BD||r===p.BD,[k,P]=(0,s.useState)(!(x||S)),j=(e=>{let{itemType:t,version:i,viewerMode:o,id:a,itemDetails:r,versionedItemData:n,authManager:d,storyMapUserPrivileges:p,config:c}=e;const h=new l.ZP({type:t,authManager:d,version:i,getStoryMapUserPrivileges:()=>p,viewerMode:o,config:c});return a&&(h.itemId=a),r&&(h.itemDetails=r),n&&(h.itemDraftData=n),(0,s.useRef)(h).current})({itemType:e,version:"draft",viewerMode:"preview",authManager:b,storyMapUserPrivileges:I,config:v,...k?{id:r,itemDetails:n,versionedItemData:c}:{}}),{initialThemeItemInfo:A,setInitialThemeItemInfo:D}=f(t.initialThemeItemInfo);(0,s.useEffect)((()=>{let t=!1;return(async()=>{try{if(!k){var i;S&&await g({pageLocale:h});const s=await(0,u.t)({id:null===(i=y)||void 0===i?void 0:i.id,config:v,signInUrl:w,authManager:b,formatMessage:T,itemType:e,shouldRedirect:!0,convertRoute:m.Q});if(t||!s.success)return;const{id:o,itemDetails:a,draftData:r,pageLocale:n,initialThemeItemInfo:l}=s;j.itemId=o,j.itemDetails=a,j.itemDraftData=r,D(l),S||await g({pageLocale:n}),P(!0)}}catch(s){P((()=>{if(s instanceof d.Z)throw new d.Z(s);throw new Error(s)}))}})(),()=>{t=!0}}),[j,D,k,e,h,g,y,v,w,b,S,T]);const M=(null===(a=y)||void 0===a?void 0:a.mode)||"preview";return{isReady:k,storyItem:j,initialThemeItemInfo:A,mode:M}}},3078:function(e,t,i){i.d(t,{b:function(){return r}});var s=i(36871),o=i(56102),a=i(43544);const r=e=>{let{itemType:t,dataPreparer:i,privilegesChecker:r}=e;return async(e,n)=>{var l;const{id:d}=e.query,{authManager:p,config:c,signInUrl:h,storyMapUserPrivileges:u}=n,m=null===(l=r)||void 0===l?void 0:l(u);if(m)throw m;if("string"!==typeof d||!(0,o.J)(d))throw new s.Z({type:"story-inaccessible",itemType:t});return await i({ctx:e,id:d,config:c,authManager:p,signInUrl:h,itemType:t,shouldRedirect:!0,convertRoute:a.Q})}}},11011:function(e,t,i){i.d(t,{h:function(){return h}});var s=i(52322),o=i(28505),a=i.n(o),r=(i(2784),i(72779)),n=i.n(r),l=i(95866),d=i(41853),p=i(64166),c=i(45822);const h=e=>{const t=(0,l.z$)(),i=e.trackingEventData?t.getDataAttributes(e.trackingEventData):{},o={styles:(0,s.jsx)(a(),{id:"fdb33912e95ade24",children:".media-toolbar-button.flipped.jsx-fdb33912e95ade24{-webkit-transform:scale(-1,1);-moz-transform:scale(-1,1);-ms-transform:scale(-1,1);-o-transform:scale(-1,1);transform:scale(-1,1)}"}),className:"jsx-fdb33912e95ade24"};return(0,s.jsx)(d.Z,{tooltipContent:e.tooltipContent,children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.ZP,{type:"single-icon",id:e.buttonId,onClick:e.onClick,className:n()("media-toolbar-button",o.className,{flipped:e.shouldFlip}),disabled:e.disabled,ariaLabel:e.tooltipContent,...i,isPressed:e.isPressed&&!e.disabled,children:(0,s.jsx)(c.Z,{...e.iconProps,size:16})}),o.styles]})},e.buttonId)};t.Z=h},52691:function(e,t,i){var s=i(52322),o=i(28505),a=i.n(o),r=i(2784),n=i(72779),l=i.n(n),d=i(64951);const p=(0,r.memo)((e=>{let{isShowing:t,toggleStoryOverlay:i,isInvisible:o}=e;const{backgroundColor:n}=(0,d.XL)(),[p,c]=(0,r.useState)(t);(0,r.useEffect)((()=>{t&&c(!0)}),[t]);return(0,s.jsxs)(s.Fragment,{children:[p&&(0,s.jsx)("div",{onAnimationEnd:async()=>{i&&(window.scrollTo(0,0),await i(!1),t||c(!1))},className:a().dynamic([["95a0d98d906354a1",[n,o?0:1]]])+" "+(l()("story-overlay",{"fade-in":!o&&t,"fade-out":!o&&!t})||"")}),(0,s.jsx)(a(),{id:"95a0d98d906354a1",dynamic:[n,o?0:1],children:`.story-overlay.__jsx-style-dynamic-selector{background-color:${n};position:fixed;width:100%;height:100%;top:0;left:0;right:0;bottom:0;z-index:2;opacity:${o?0:1};pointer-events:none}.fade-in.__jsx-style-dynamic-selector{-webkit-animation:fadeIn 250ms ease-in;-moz-animation:fadeIn 250ms ease-in;-o-animation:fadeIn 250ms ease-in;animation:fadeIn 250ms ease-in}@-webkit-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}.fade-out.__jsx-style-dynamic-selector{-webkit-animation:fadeOut 250ms ease-out;-moz-animation:fadeOut 250ms ease-out;-o-animation:fadeOut 250ms ease-out;animation:fadeOut 250ms ease-out}@-webkit-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@-moz-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@-o-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@keyframes fadeOut{0%{opacity:1}100%{opacity:0}}`})]})}));t.Z=p},2771:function(e,t,i){i.d(t,{AD:function(){return g},An:function(){return d},Cd:function(){return a},Cx:function(){return s},Kj:function(){return l},O4:function(){return c},XR:function(){return h},fS:function(){return p},jf:function(){return o},l:function(){return u},li:function(){return n},oc:function(){return m},qi:function(){return f},sk:function(){return r}});const s="item-end-reached",o="stop-scrolling-item",a="autoplay-next-item",r="toggle-item-autoplay",n="toggle-item-speed",l="reset-item",d="iframe-ready-for-communication",p="enable-item-autoplay",c="disable-item-autoplay",h="update-parent-pause",u="active-item-iframe",m=1500,g=1e3,f={slow:{displaySpeed:"1/2x",pageScrollDelay:40,collectionAutoplayDuration:12e4},medium:{displaySpeed:"1x",pageScrollDelay:20,collectionAutoplayDuration:6e4},fast:{displaySpeed:"2x",pageScrollDelay:10,collectionAutoplayDuration:3e4}}},48713:function(e,t,i){i.d(t,{Z:function(){return Ne}});var s=i(52322),o=i(28505),a=i.n(o),r=i(2784),n=i(42670),l=i(89274),d=i(72779),p=i.n(d),c=i(97729),h=i.n(c),u=i(90457),m=i(14535),g=i(9286),f=i(34321),y=i(58204),x=i(72603),v=i(15352),w=i(62917),b=i(24782),I=i(11230),T=i(23038),S=i(28184),k=i(67952),P=i(78698),j=i(47491),A=i(57293),D=i(5138),M=i(45822),C=i(72166);var $=e=>{const t=(0,C.Z)(),{theme:i}=(0,m.Fj)(),o=(0,v.uw)();return(0,s.jsxs)("div",{className:a().dynamic([["652b8552a628b806",[g.default.spacing.sm,A.ZP.shadow.sm(),A.ZP.overflowWrap(),g.default.spacing.xxs,g.default.spacing.xxs,g.default.spacing.xxs,g.default.color.white,g.default.spacing.xs,g.default.spacing.xxs,A.ZP.typography.subtitleSmall(),g.default.color.darkGreen,g.default.spacing.xxxs,g.default.spacing.xs,g.default.spacing.md,A.ZP.typography.bodySmall(),g.default.color.cadet,g.default.spacing.xs,g.default.spacing.xs,g.default.spacing.xxs,i.colors.labelLink,A.ZP.typography.bodyLarge(),g.default.spacing.xxxxs,g.default.spacing.xxxxs,g.default.spacing.xxxs,f.K.RTL,g.default.spacing.xxxxs,g.default.responsiveBreakpoints.large,g.default.responsiveBreakpoints.extraLarge]]])+" container",children:[(0,s.jsx)("h3",{className:a().dynamic([["652b8552a628b806",[g.default.spacing.sm,A.ZP.shadow.sm(),A.ZP.overflowWrap(),g.default.spacing.xxs,g.default.spacing.xxs,g.default.spacing.xxs,g.default.color.white,g.default.spacing.xs,g.default.spacing.xxs,A.ZP.typography.subtitleSmall(),g.default.color.darkGreen,g.default.spacing.xxxs,g.default.spacing.xs,g.default.spacing.md,A.ZP.typography.bodySmall(),g.default.color.cadet,g.default.spacing.xs,g.default.spacing.xs,g.default.spacing.xxs,i.colors.labelLink,A.ZP.typography.bodyLarge(),g.default.spacing.xxxxs,g.default.spacing.xxxxs,g.default.spacing.xxxs,f.K.RTL,g.default.spacing.xxxxs,g.default.responsiveBreakpoints.large,g.default.responsiveBreakpoints.extraLarge]]])+" title",children:t("component.builderHeader.storySettings.analytics.message.title")}),(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:e.message},className:a().dynamic([["652b8552a628b806",[g.default.spacing.sm,A.ZP.shadow.sm(),A.ZP.overflowWrap(),g.default.spacing.xxs,g.default.spacing.xxs,g.default.spacing.xxs,g.default.color.white,g.default.spacing.xs,g.default.spacing.xxs,A.ZP.typography.subtitleSmall(),g.default.color.darkGreen,g.default.spacing.xxxs,g.default.spacing.xs,g.default.spacing.md,A.ZP.typography.bodySmall(),g.default.color.cadet,g.default.spacing.xs,g.default.spacing.xs,g.default.spacing.xxs,i.colors.labelLink,A.ZP.typography.bodyLarge(),g.default.spacing.xxxxs,g.default.spacing.xxxxs,g.default.spacing.xxxs,f.K.RTL,g.default.spacing.xxxxs,g.default.responsiveBreakpoints.large,g.default.responsiveBreakpoints.extraLarge]]])+" message-container"}),(0,s.jsx)(D.Z,{primaryButtonTitle:t("component.builderHeader.storySettings.analytics.message.button.allow"),onPrimaryButtonClick:e.onAllowClicked,orientation:o.isViewportMinWidth("medium")?"horizontal":"vertical",startContent:(0,s.jsx)("h4",{className:a().dynamic([["652b8552a628b806",[g.default.spacing.sm,A.ZP.shadow.sm(),A.ZP.overflowWrap(),g.default.spacing.xxs,g.default.spacing.xxs,g.default.spacing.xxs,g.default.color.white,g.default.spacing.xs,g.default.spacing.xxs,A.ZP.typography.subtitleSmall(),g.default.color.darkGreen,g.default.spacing.xxxs,g.default.spacing.xs,g.default.spacing.md,A.ZP.typography.bodySmall(),g.default.color.cadet,g.default.spacing.xs,g.default.spacing.xs,g.default.spacing.xxs,i.colors.labelLink,A.ZP.typography.bodyLarge(),g.default.spacing.xxxxs,g.default.spacing.xxxxs,g.default.spacing.xxxs,f.K.RTL,g.default.spacing.xxxxs,g.default.responsiveBreakpoints.large,g.default.responsiveBreakpoints.extraLarge]]])+" footer-label",children:t("component.builderHeader.storySettings.analytics.message.allowTracking")})}),(0,s.jsx)("button",{"aria-label":t("common.close"),onClick:e.onDismissClicked,className:a().dynamic([["652b8552a628b806",[g.default.spacing.sm,A.ZP.shadow.sm(),A.ZP.overflowWrap(),g.default.spacing.xxs,g.default.spacing.xxs,g.default.spacing.xxs,g.default.color.white,g.default.spacing.xs,g.default.spacing.xxs,A.ZP.typography.subtitleSmall(),g.default.color.darkGreen,g.default.spacing.xxxs,g.default.spacing.xs,g.default.spacing.md,A.ZP.typography.bodySmall(),g.default.color.cadet,g.default.spacing.xs,g.default.spacing.xs,g.default.spacing.xxs,i.colors.labelLink,A.ZP.typography.bodyLarge(),g.default.spacing.xxxxs,g.default.spacing.xxxxs,g.default.spacing.xxxs,f.K.RTL,g.default.spacing.xxxxs,g.default.responsiveBreakpoints.large,g.default.responsiveBreakpoints.extraLarge]]])+" close-button",children:(0,s.jsx)(M.Z,{path:j.n,size:16,fill:i.colors.labelPrimary})}),(0,s.jsx)(a(),{id:"652b8552a628b806",dynamic:[g.default.spacing.sm,A.ZP.shadow.sm(),A.ZP.overflowWrap(),g.default.spacing.xxs,g.default.spacing.xxs,g.default.spacing.xxs,g.default.color.white,g.default.spacing.xs,g.default.spacing.xxs,A.ZP.typography.subtitleSmall(),g.default.color.darkGreen,g.default.spacing.xxxs,g.default.spacing.xs,g.default.spacing.md,A.ZP.typography.bodySmall(),g.default.color.cadet,g.default.spacing.xs,g.default.spacing.xs,g.default.spacing.xxs,i.colors.labelLink,A.ZP.typography.bodyLarge(),g.default.spacing.xxxxs,g.default.spacing.xxxxs,g.default.spacing.xxxs,f.K.RTL,g.default.spacing.xxxxs,g.default.responsiveBreakpoints.large,g.default.responsiveBreakpoints.extraLarge],children:`.container.__jsx-style-dynamic-selector{--space-from-bottom:${g.default.spacing.sm};${A.ZP.shadow.sm()}\n          ${A.ZP.overflowWrap()}\n          position: fixed;z-index:9999;bottom:var(--space-from-bottom);left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);width:100%;max-width:-webkit-calc(100% - ${g.default.spacing.xxs} - ${g.default.spacing.xxs});max-width:-moz-calc(100% - ${g.default.spacing.xxs} - ${g.default.spacing.xxs});max-width:calc(100% - ${g.default.spacing.xxs} - ${g.default.spacing.xxs});max-height:-webkit-calc(100vh - var(--space-from-bottom) - ${g.default.spacing.xxs});max-height:-moz-calc(100vh - var(--space-from-bottom) - ${g.default.spacing.xxs});max-height:calc(100vh - var(--space-from-bottom) - ${g.default.spacing.xxs});display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background-color:${g.default.color.white};padding:${g.default.spacing.xs} 0 ${g.default.spacing.xxs}}.title.__jsx-style-dynamic-selector{${A.ZP.typography.subtitleSmall()}\n          color: ${g.default.color.darkGreen};margin-bottom:${g.default.spacing.xxxs};-webkit-padding-start:${g.default.spacing.xs};-moz-padding-start:${g.default.spacing.xs};padding-inline-start:${g.default.spacing.xs};-webkit-padding-end:${g.default.spacing.md};-moz-padding-end:${g.default.spacing.md};padding-inline-end:${g.default.spacing.md}}.message-container.__jsx-style-dynamic-selector{${A.ZP.typography.bodySmall()}\n          overflow-y: auto;color:${g.default.color.cadet};-webkit-padding-start:${g.default.spacing.xs};-moz-padding-start:${g.default.spacing.xs};padding-inline-start:${g.default.spacing.xs};-webkit-padding-end:${g.default.spacing.xs};-moz-padding-end:${g.default.spacing.xs};padding-inline-end:${g.default.spacing.xs};padding-bottom:${g.default.spacing.xxs}}.message-container.__jsx-style-dynamic-selector a,.message-container.__jsx-style-dynamic-selector a:visited{color:${i.colors.labelLink}}.footer-label.__jsx-style-dynamic-selector{${A.ZP.typography.bodyLarge()}\n        }.close-button.__jsx-style-dynamic-selector{position:absolute;top:${g.default.spacing.xxxxs};right:${g.default.spacing.xxxxs};padding:${g.default.spacing.xxxs};line-height:0}${f.K.RTL} .close-button.__jsx-style-dynamic-selector{right:unset;left:${g.default.spacing.xxxxs}}@media(min-width:${g.default.responsiveBreakpoints.large}){.container.__jsx-style-dynamic-selector{width:75%;max-width:${g.default.responsiveBreakpoints.extraLarge}}}`})]})},L=i(97193),_=i(64951),R=i(23175),Z=i(69405),E=i(18238),B=i(76033),H=i(56509),O=i(23559),z=i(36968),N=i(63789),U=i(30296),W=i(64417),V=i(56463),F=i(52691),K=i(95101);var q=i(64233),G=i(66974),Y=i(64166);const X={"1/2x":"M15 23H8.1v-.5c0-2.157 1.762-3.105 3.316-3.942 1.392-.748 2.593-1.394 2.593-2.721 0-1.046-1.184-1.837-2.47-1.855a2.38 2.38 0 0 0-2.001.72A2.118 2.118 0 0 0 8.973 16h-.97a2.954 2.954 0 0 1 .823-2 3.437 3.437 0 0 1 2.727-1c1.828 0 3.438 1.245 3.438 2.837 0 1.924-1.639 2.815-3.1 3.602-1.273.685-2.482 1.335-2.74 2.561H15zM11 3.422l-.916-.4-8.077 18.57.916.4zM4 2.207L1.011 3.634l.43.903L3 3.793v8.167h1zM22.689 9L20.5 11.696 18.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L22.689 16h1.306l-2.842-3.5L23.995 9z","1x":"M9 21H8V4.743L4.804 6l-.377-.882L9 3.257zm9.689-12L16.5 11.696 14.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L18.689 16h1.306l-2.842-3.5L19.995 9z","2x":"M13 20H2.004v-.5c0-3.497 2.885-5.076 5.43-6.469 2.352-1.287 4.575-2.504 4.575-5.007a4.172 4.172 0 0 0-4.173-4.038A4.693 4.693 0 0 0 4.31 5.304a5.604 5.604 0 0 0-1.315 3.685l-.989.005A6.475 6.475 0 0 1 3.59 4.611a5.63 5.63 0 0 1 4.246-1.598A5.155 5.155 0 0 1 13 8.024c0 3.096-2.581 4.514-5.086 5.884-2.376 1.3-4.627 2.532-4.886 5.092H13zm8.689-11L19.5 11.696 17.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L21.689 16h1.306l-2.842-3.5L22.995 9z"};class J extends r.PureComponent{constructor(e){super(e),this.setHoverState=()=>{this.state.isHovering||this.setState({isShowing:!0,isHovering:!0})},this.removeHoverState=()=>{this.state.isHovering&&this.setState({isHovering:!1})},this.state={isShowing:this.props.isShowing,isHovering:!1}}componentDidUpdate(){this.props.isShowing===this.state.isShowing||this.state.isHovering||this.setState({isShowing:this.props.isShowing})}render(){const e=this.state.isShowing?"visible":"hidden",t=this.props.intl.formatMessage({id:"component.autoplay.returnToTop"}),i=this.props.intl.formatMessage({id:"common.autoplay.play"}),o=this.props.intl.formatMessage({id:"common.autoplay.pause"}),r=this.props.intl.formatMessage({id:"component.autoplay.toggleSpeed"});return(0,s.jsxs)("div",{onMouseEnter:this.setHoverState,onMouseLeave:this.removeHoverState,className:a().dynamic([["72630bf892672ed8",[this.props.appOffset.bottom,g.default.spacing.xxl,g.default.spacing.xxxxs,A.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,this.state.isShowing?1:0,g.default.spacing.xs,g.default.spacing.md,A.ZP.gapped({direction:"horizontal",gap:g.default.spacing.xs,alignItems:"center",justifyContent:"center"})]]])+" autoplay",children:[(0,s.jsxs)("div",{className:a().dynamic([["72630bf892672ed8",[this.props.appOffset.bottom,g.default.spacing.xxl,g.default.spacing.xxxxs,A.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,this.state.isShowing?1:0,g.default.spacing.xs,g.default.spacing.md,A.ZP.gapped({direction:"horizontal",gap:g.default.spacing.xs,alignItems:"center",justifyContent:"center"})]]])+" autoplay-controls-wrapper",children:[(0,s.jsx)(Y.ZP,{type:"single-icon",onClick:this.props.onResetClick,ariaLabel:t,children:(0,s.jsx)(M.Z,{path:G.M})}),this.props.isPlaying?(0,s.jsx)(Y.ZP,{type:"single-icon",onClick:this.props.onPlayToggle,ariaLabel:o,children:(0,s.jsx)(M.Z,{path:"M4 2h6v20H4zm10 20h6V2h-6z"})}):(0,s.jsx)(Y.ZP,{type:"single-icon",onClick:this.props.onPlayToggle,ariaLabel:i,children:(0,s.jsx)(M.Z,{path:q.C})}),(0,s.jsx)(Y.ZP,{type:"single-icon",onClick:this.props.onSpeedToggle,ariaLabel:r,children:(0,s.jsx)(M.Z,{path:X[this.props.speed]})})]}),(0,s.jsx)(a(),{id:"72630bf892672ed8",dynamic:[this.props.appOffset.bottom,g.default.spacing.xxl,g.default.spacing.xxxxs,A.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,this.state.isShowing?1:0,g.default.spacing.xs,g.default.spacing.md,A.ZP.gapped({direction:"horizontal",gap:g.default.spacing.xs,alignItems:"center",justifyContent:"center"})],children:`.autoplay.__jsx-style-dynamic-selector{position:fixed;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);bottom:-webkit-calc(${this.props.appOffset.bottom} + ${g.default.spacing.xxl});bottom:-moz-calc(${this.props.appOffset.bottom} + ${g.default.spacing.xxl});bottom:calc(${this.props.appOffset.bottom} + ${g.default.spacing.xxl});-webkit-border-radius:${g.default.spacing.xxxxs};-moz-border-radius:${g.default.spacing.xxxxs};border-radius:${g.default.spacing.xxxxs};background-color:${A.ZP.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85)};z-index:10;visibility:${e};opacity:${this.state.isShowing?1:0};-webkit-transition:opacity.5s linear,visibility.5s linear;-moz-transition:opacity.5s linear,visibility.5s linear;-o-transition:opacity.5s linear,visibility.5s linear;transition:opacity.5s linear,visibility.5s linear;padding:${g.default.spacing.xs} ${g.default.spacing.md}}.autoplay-controls-wrapper.__jsx-style-dynamic-selector{${A.ZP.gapped({direction:"horizontal",gap:g.default.spacing.xs,alignItems:"center",justifyContent:"center"})};}`})]})}}var Q=(0,m.EL)((0,E.Jh)((0,l.ZP)(J))),ee=i(2771);class te extends r.PureComponent{constructor(e){super(e),this.lastMouseMoveTime=0,this.lastScrollTime=0,this.isReaderScrolling=!1,this.autoplayNode=(0,r.createRef)(),this.autoplayEnabledSetup=async()=>{var e;((0,I.xR)()||this.toggleAutoplay(),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("wheel",this.handleWindowScroll),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("touchstart",this.handleMouseDown),this.interactionTimer=window.setInterval(this.interactionDelayCheck,500),this.props.collectionBlock)&&(await(null===(e=this.props.collectionBlock)||void 0===e?void 0:e.do("switchToCurrentActiveItem")),this.autoplayCollectionItem())},this.autoplayDisabledCleanup=()=>{clearInterval(this.interactionTimer),clearInterval(this.scrollTimer),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("wheel",this.handleWindowScroll),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("touchstart",this.handleMouseDown),clearTimeout(this.collectionTimeoutId),this.postMessageToActiveItemIframe(ee.O4)},this.onReceiveMessage=e=>{if(e.origin===window.location.origin)if((0,I.xR)()){var t,i;if(e.data.method===ee.jf&&window.parent.postMessage({method:ee.Cd},window.location.origin),e.data.method===ee.fS&&e.data.speed&&(this.props.enableAutoplay(),this.props.updateAutoplaySpeed(e.data.speed),this.props.isAutoplayPaused&&this.toggleAutoplay()),e.data.method===ee.O4&&(this.props.disableAutoplay(),this.props.isAutoplayPaused||this.toggleAutoplay()),e.data.method===ee.sk&&this.toggleAutoplay(),e.data.method===ee.li&&e.data.speed&&this.props.updateAutoplaySpeed(e.data.speed),e.data.method===ee.Kj)null===(t=(i=this.props).onScrolledToBottom)||void 0===t||t.call(i),this.props.updateIsAutoplayPaused(!1),this.scrollPage()}else{var s,o;if(this.props.isAutoplayEnabled&&e.data.method===ee.An)null===(s=e.source)||void 0===s||s.postMessage({method:ee.fS,speed:this.props.autoplaySpeed});if(e.data.method===ee.Cx)null===(o=e.source)||void 0===o||o.postMessage({method:ee.jf});e.data.method===ee.Cd&&this.switchToNextItem(),e.data.method===ee.XR&&"boolean"===typeof e.data.isPaused&&this.props.isAutoplayPaused!==e.data.isPaused&&this.props.updateIsAutoplayPaused(e.data.isPaused)}},this.switchToNextItem=async e=>{var t;await(null===(t=this.props.collectionBlock)||void 0===t?void 0:t.do("switchToNextItem",e)),this.autoplayCollectionItem()},this.switchToFirstCollectionItem=()=>{this.switchToNextItem(0)},this.autoplayCollectionItem=()=>{var e,t,i;const s=null===(e=this.props.collectionBlock)||void 0===e?void 0:e.do("getActiveItemBlock");if(!s)return;const o=s.do("isStoryMap"),a=s.do("getBlockItemType"),r=null===(i=s.do("getItemUrl"))||void 0===i?void 0:i.startsWith(null===(t=window)||void 0===t?void 0:t.origin),n=ee.qi[this.props.autoplaySpeed].collectionAutoplayDuration;"embed"===a&&r||o&&r||(clearTimeout(this.collectionTimeoutId),this.collectionTimeoutId=setTimeout((()=>{this.switchToNextItem()}),n))},this.postMessageToActiveItemIframe=(e,t)=>{var i,s;null===(s=null===(i=document.querySelector(`.${ee.l}`))||void 0===i?void 0:i.contentWindow)||void 0===s||s.postMessage({method:e,...t})},this.toggleAutoplay=e=>{var t;const i=!this.props.isAutoplayPaused;null===(t=e)||void 0===t||t.preventDefault(),this.props.updateIsAutoplayPaused(i),this.props.collectionBlock?(this.postMessageToActiveItemIframe(ee.sk),i?clearTimeout(this.collectionTimeoutId):this.autoplayCollectionItem()):(window.parent.postMessage({method:ee.XR,isPaused:i}),this.scrollPage())},this.handleWindowScroll=e=>{(e.deltaY>0||e.deltaY<0)&&(this.updateScrollTime(),this.isReaderScrolling=!0,this.props.isAutoplayPaused||(this.props.updateIsAutoplayPaused(!0),clearTimeout(this.collectionTimeoutId),this.postMessageToActiveItemIframe(ee.sk)))},this.handleMouseDown=e=>{var t;this.props.isAutoplayPaused||(null===(t=this.autoplayNode.current)||void 0===t?void 0:t.contains(e.target))||(this.props.updateIsAutoplayPaused(!0),clearInterval(this.scrollTimer),clearTimeout(this.collectionTimeoutId),this.postMessageToActiveItemIframe(ee.sk))},this.updateScrollTime=()=>{this.lastScrollTime=Date.now()},this.handleMouseMove=()=>{this.lastMouseMoveTime=Date.now(),this.setState({areAutoplayControlsShowing:!0})},this.interactionDelayCheck=()=>{this.autoplayNode.current?this.isReaderScrolling?this.onReaderScrolling():this.onReaderNotScrolling():clearInterval(this.interactionTimer)},this.onReaderScrolling=()=>{Date.now()>this.lastScrollTime+ee.AD?this.isReaderScrolling=!1:this.setState({areAutoplayControlsShowing:!0})},this.onReaderNotScrolling=()=>{Date.now()>this.lastMouseMoveTime+ee.oc&&!this.props.isAutoplayPaused?this.setState({areAutoplayControlsShowing:!1}):this.setState({areAutoplayControlsShowing:!0})},this.toggleAutoplaySpeed=()=>{"fast"===this.props.autoplaySpeed?this.props.updateAutoplaySpeed("slow"):"slow"===this.props.autoplaySpeed?this.props.updateAutoplaySpeed("medium"):this.props.updateAutoplaySpeed("fast")},this.onResetClick=()=>{this.props.collectionBlock?(clearTimeout(this.collectionTimeoutId),this.switchToFirstCollectionItem(),this.postMessageToActiveItemIframe(ee.Kj),this.props.updateIsAutoplayPaused(!1)):this.jumpToTop()},this.jumpToTop=()=>{var e,t;null===(e=(t=this.props).onScrolledToBottom)||void 0===e||e.call(t),window.parent.postMessage({method:ee.Cx},window.location.origin),this.props.updateIsAutoplayPaused(!1),this.scrollPage()},this.scrollPage=()=>{const e=ee.qi[this.props.autoplaySpeed].pageScrollDelay;clearInterval(this.scrollTimer),this.scrollTimer=window.setInterval((()=>{!this.props.isAutoplayPaused&&this.autoplayNode.current?0===window.scrollY?(clearInterval(this.scrollTimer),setTimeout((()=>{window.scrollBy(0,2),this.scrollPage()}),2e3)):Math.round(window.innerHeight+window.scrollY)>=document.body.offsetHeight?(clearInterval(this.scrollTimer),setTimeout(this.jumpToTop,3e3)):window.scrollBy(0,2):clearInterval(this.scrollTimer)}),e)},this.state={areAutoplayControlsShowing:!1}}componentDidMount(){window.addEventListener("message",this.onReceiveMessage,!1),(0,I.xR)()&&window.parent.postMessage({method:ee.An},window.location.origin)}componentDidUpdate(e,t){e.autoplaySpeed!==this.props.autoplaySpeed&&(this.scrollPage(),this.postMessageToActiveItemIframe(ee.li,{speed:this.props.autoplaySpeed})),!e.isAutoplayEnabled&&this.props.isAutoplayEnabled&&this.autoplayEnabledSetup(),e.isAutoplayEnabled&&!this.props.isAutoplayEnabled&&this.autoplayDisabledCleanup(),(0,I.xR)()&&!this.props.isAutoplayEnabled&&window.parent.postMessage({method:ee.An},window.location.origin);const i=this.props.collectionDisplay.isCoverShowing;!e.collectionDisplay.isCoverShowing&&i&&this.props.isAutoplayEnabled&&this.props.disableAutoplay()}componentWillUnmount(){window.removeEventListener("message",this.onReceiveMessage,!1),this.autoplayDisabledCleanup()}render(){return this.props.isAutoplayEnabled?(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(V.Z,{triggerKey:" ",on:this.toggleAutoplay}),!this.props.isAutoplayPaused&&(0,s.jsx)(F.Z,{isShowing:!0,isInvisible:!0}),(0,s.jsx)("div",{ref:this.autoplayNode,children:(0,s.jsx)(Q,{isShowing:!(0,I.xR)()&&this.state.areAutoplayControlsShowing,speed:ee.qi[this.props.autoplaySpeed].displaySpeed,isPlaying:!this.props.isAutoplayPaused,onResetClick:this.onResetClick,onPlayToggle:this.toggleAutoplay,onSpeedToggle:this.toggleAutoplaySpeed})})]}):null}}var ie=(0,K.p)((0,W.HH)(te)),se=i(47423),oe=i(95445),ae=i(99070);var re=i(35111),ne=i(62056);const le={phone:{landscape:{width:734,height:388,fileName:"frame-phone-landscape.png"},portrait:{width:388,height:734,fileName:"frame-phone.png"}},tablet:{landscape:{width:1100,height:782,fileName:"frame-tablet-landscape.png"},portrait:{width:782,height:1100,fileName:"frame-tablet.png"}},desktop:{landscape:{width:1370,height:878,fileName:"frame-desktop.png"},portrait:{width:1370,height:878,fileName:"frame-desktop.png"}}};class de extends r.Component{constructor(e){super(e),this.margins={top:65,bottom:130,side:65},this.scaleWrapper=(0,r.createRef)(),this.scaledPreview=(0,r.createRef)(),this.previewIframe=(0,r.createRef)(),this.handleResize=()=>{this.forceUpdate()},this.findTransformScale=()=>{var e;const t=null===(e=this.scaleWrapper.current)||void 0===e?void 0:e.getBoundingClientRect();if(!t)return 1;const i=le[this.props.device],s=Math.round(t.height-this.margins.top-this.margins.bottom),o=Math.min(s/i.portrait.height,1),a=Math.round(t.width-2*this.margins.side),r=Math.min(a/i.landscape.width,1);return+Math.min(o,r).toFixed(2)},this.findTopPosition=e=>{if(!this.scaleWrapper.current||!this.scaledPreview.current)return 0;const t=Math.round(this.scaleWrapper.current.getBoundingClientRect().height),i=Math.round(e||this.scaledPreview.current.getBoundingClientRect().height);return this.margins.top+(t-i-this.margins.top-this.margins.bottom)/2},this.handleResizeDebouncedly=(0,re.Ds)(this.handleResize,200)}componentDidMount(){this.forceUpdate(),this.scrollWindowToTop(),window.addEventListener("resize",this.handleResizeDebouncedly)}componentDidUpdate(e){e.device===this.props.device&&e.orientation===this.props.orientation||this.scrollIframeToTop()}componentWillUnmount(){window.removeEventListener("resize",this.handleResizeDebouncedly)}render(){const e=le[this.props.device][this.props.orientation],t=this.findTransformScale(),i=Math.round(e.height*t),o=this.findTopPosition(i),n=this.props.query?(0,ne.qC)(this.props.query):void 0,l=void 0===this.props.selectedItemId?n?`./embedded-preview?${n}`:"./embedded-preview":n?`./embedded-preview?item=${this.props.selectedItemId}&${n}`:`./embedded-preview?item=${this.props.selectedItemId}`;return(0,s.jsx)(r.Fragment,{children:(0,s.jsxs)("div",{ref:this.scaleWrapper,className:a().dynamic([["522d15eaaa8d842a",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" "+`scale-wrapper ${this.props.device} ${this.props.orientation}`,children:[(0,s.jsx)("div",{className:a().dynamic([["522d15eaaa8d842a",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" scaled",children:(0,s.jsx)("div",{ref:this.scaledPreview,className:a().dynamic([["522d15eaaa8d842a",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" center-horizontally scaled-preview",children:(0,s.jsxs)("div",{className:a().dynamic([["522d15eaaa8d842a",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" preview-container specified-dimensions",children:[(0,s.jsx)("img",{src:`${this.props.config.BASE_URL}/static/storymaps-website-common/images/device-preview/${e.fileName}`,alt:this.props.intl.formatMessage({id:"component.preview.chromeAlt"}),loading:"lazy",className:a().dynamic([["522d15eaaa8d842a",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" device-chrome"}),(0,s.jsx)("iframe",{src:l,ref:this.previewIframe,loading:"lazy",className:a().dynamic([["522d15eaaa8d842a",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])})]})})}),"desktop"!==this.props.device&&(0,s.jsx)("div",{className:a().dynamic([["522d15eaaa8d842a",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" rotate-button-wrapper center-horizontally",children:(0,s.jsx)(Y.ZP,{type:"single-icon",iconSize:24,onClick:this.props.onOrientationChange,ariaLabel:this.props.intl.formatMessage({id:"component.preview.rotateLabel"}),children:(0,s.jsx)(M.Z,{path:"M21.323 8.616l-4.94-4.94a1.251 1.251 0 0 0-1.767 0l-10.94 10.94a1.251 1.251 0 0 0 0 1.768l4.94 4.94a1.25 1.25 0 0 0 1.768 0l10.94-10.94a1.251 1.251 0 0 0 0-1.768zM14 5.707L19.293 11 11.5 18.793 6.207 13.5zm-4.323 14.91a.25.25 0 0 1-.354 0l-1.47-1.47.5-.5-2-2-.5.5-1.47-1.47a.25.25 0 0 1 0-.354L5.5 14.207l5.293 5.293zm10.94-10.94l-.617.616L14.707 5l.616-.616a.25.25 0 0 1 .354 0l4.94 4.94a.25.25 0 0 1 0 .353zm1.394 6.265V18a3.003 3.003 0 0 1-3 3h-3.292l1.635 1.634-.707.707-2.848-2.847 2.848-2.848.707.707L15.707 20h3.304a2.002 2.002 0 0 0 2-2v-2.058zM4 9H3V7a3.003 3.003 0 0 1 3-3h3.293L7.646 2.354l.707-.707 2.848 2.847L8.354 7.34l-.707-.707L9.28 5H6a2.002 2.002 0 0 0-2 2z"})})}),(0,s.jsx)(a(),{id:"522d15eaaa8d842a",dynamic:[this.props.websiteDesign.theme.colors.backgroundSecondary,t,o,g.default.spacing.lg,this.props.device,this.props.orientation,e.width,e.height],children:`.center-horizontally.__jsx-style-dynamic-selector{position:absolute;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);top:0}.scale-wrapper.__jsx-style-dynamic-selector{height:100vh;position:relative;background-color:${this.props.websiteDesign.theme.colors.backgroundSecondary}}.scaled.__jsx-style-dynamic-selector{-webkit-transform:scale(${t});-moz-transform:scale(${t});-ms-transform:scale(${t});-o-transform:scale(${t});transform:scale(${t});position:relative;top:${o}px}.preview-container.__jsx-style-dynamic-selector{margin:0 auto}.rotate-button-wrapper.__jsx-style-dynamic-selector{top:auto;bottom:${g.default.spacing.lg}}iframe.__jsx-style-dynamic-selector{position:absolute;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.${this.props.device}.${this.props.orientation}.__jsx-style-dynamic-selector .specified-dimensions.__jsx-style-dynamic-selector{width:${e.width}px;height:${e.height}px}.phone.portrait.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:4.8%;left:1.9%;height:90.4%;width:96.3%}.phone.landscape.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{left:4.8%;top:1.9%;width:90.4%;height:96.3%}.tablet.portrait.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:4.6%;left:1.4%;height:90.6%;width:97.2%}.tablet.landscape.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{left:4.6%;top:1.4%;width:90.6%;height:97.2%}.desktop.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:6.4%;left:1.8%;width:96.5%;height:90.9%}`})]})})}scrollWindowToTop(){var e,t;const i=null===(t=window)||void 0===t||null===(e=t.document)||void 0===e?void 0:e.documentElement;i&&(i.scrollTop=0)}scrollIframeToTop(){try{var e,t,i,s;const o=null===(s=this.previewIframe)||void 0===s||null===(i=s.current)||void 0===i||null===(t=i.contentWindow)||void 0===t||null===(e=t.document)||void 0===e?void 0:e.documentElement;o&&this.scrollToTop(o)}catch(o){}}scrollToTop(e){if(e.scrollTop>0){const t=e.clientHeight?Math.round(e.clientHeight/2):300;setTimeout((()=>{e.scrollBy(0,-1*t),this.scrollToTop(e)}),10)}}}var pe=(0,m.EL)((0,l.ZP)((0,S.Df)(de)));var ce=i(62778),he=i(55542);var ue=i(41853),me=i(34578),ge=i(11011),fe=i(39449),ye=i(71455),xe=i(21348);const ve="storyPreviewControlsNudge",we="collectionPreviewControlsNudge";class be extends r.Component{static#e=(()=>{this.defaultProps={device:"fullscreen",onDeviceChange:()=>{}}})();constructor(e){super(e),this.deviceSpecs=[{value:"phone",iconProps:{path:ce.I},stringId:"component.previewHeader.device.phone",isUnavailable:this.props.itemType===N.o.Briefing},{value:"tablet",iconProps:{path:"M15 14a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H1a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1zm-.25-10a.25.25 0 0 1 .25.25v8.5a.25.25 0 0 1-.25.25H14V4zM13 4v9H4V4zM1 9h1V8H1V4.25A.25.25 0 0 1 1.25 4H3v9H1.25a.25.25 0 0 1-.25-.25z",shouldFlipRTL:!0},stringId:"component.previewHeader.device.tablet",isUnavailable:this.props.itemType===N.o.Briefing},{value:"desktop",iconProps:{path:he.G},stringId:"component.previewHeader.device.desktop"},{value:"fullscreen",iconProps:{path:"M0 1v14h16V1zm1 13V5h4v9zm14 0H6V5h9zm0-10h-1V3h-1v1H1V2h14z",shouldFlipRTL:!0},stringId:"component.previewHeader.device.full"}],this.renderControls=()=>{const e=this.props.intl.formatMessage({id:"component.preview.controls.close"});return(0,s.jsxs)("div",{className:a().dynamic([["b115d6f53bbfeb8a",[A.ZP.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"}),A.ZP.shadow.md(),this.props.websiteDesign.theme.colors.surfaceDefault,this.props.websiteDesign.productVariables.borderRadius.mid]]])+" preview-controls",children:[this.deviceSpecs.map((e=>{if(e.isUnavailable)return;const t=e.value,i=this.props.intl.formatMessage({id:e.stringId});return(0,s.jsx)(ge.h,{isPressed:this.props.device===t,iconProps:e.iconProps,buttonId:e.stringId,onClick:()=>{this.onPreviewChangeWrapper(t)},tooltipContent:i},`${t}-frag`)})),(0,s.jsx)(fe.Z,{}),(0,s.jsx)(ye.e,{routeDef:{route:"builder",itemId:this.props.itemId,itemType:this.props.itemType},children:(0,s.jsx)(Y.ZP,{type:"single-icon",className:"edit-link",ariaLabel:e,children:(0,s.jsx)(ue.Z,{tooltipContent:e,children:(0,s.jsx)(M.Z,{path:j.n,size:16})})})}),(0,s.jsx)(a(),{id:"b115d6f53bbfeb8a",dynamic:[A.ZP.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"}),A.ZP.shadow.md(),this.props.websiteDesign.theme.colors.surfaceDefault,this.props.websiteDesign.productVariables.borderRadius.mid],children:`.preview-controls.__jsx-style-dynamic-selector{${A.ZP.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"})};${A.ZP.shadow.md()}\n            background-color: ${this.props.websiteDesign.theme.colors.surfaceDefault};-webkit-border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};-moz-border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};color:inherit}`})]})},this.onPreviewChangeWrapper=e=>{this.props.onDeviceChange&&this.props.onDeviceChange(e)},this.onNudgeDismissed=()=>{this.setState({hasSeenNudge:!0}),(0,xe.s)({id:this.props.itemType===N.o.Story?ve:we,value:!0})},this.state={hasSeenNudge:!!(0,xe.n)({id:this.props.itemType===N.o.Story?ve:we})}}render(){return(0,s.jsx)(me.Z,{target:this.renderControls(),title:this.props.intl.formatMessage({id:"component.preview.controls.nudge.description"}),placement:"top",isShowing:!!this.props.canShowNudge&&!this.state.hasSeenNudge,onClick:this.onNudgeDismissed})}}var Ie=(0,m.EL)((0,S.Df)((0,l.ZP)((0,E.Jh)(be)))),Te=i(80979),Se=i(54058),ke=i(43746),Pe=i(73927),je=i(55098),Ae=i(96934);const De=(e,t,i,s,o,a,r,n,l)=>JSON.stringify({"@context":"https://schema.org","@type":"NewsArticle",mainEntityOfPage:{"@type":"WebPage","@id":e},headline:`${a}`,image:[`${t}`],datePublished:`${i}`,dateModified:`${s}`,author:{"@type":"Person",name:`${o}`},publisher:{"@type":"Organization",name:"Esri",logo:{"@type":"ImageObject",url:`${n}${l.BASE_URL}/static/images/logo.png`}},description:`${r}`}),Me=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("link",{rel:"preconnect",href:"https://www.arcgis.com"}),(0,s.jsx)("link",{rel:"preconnect",href:"https://js.arcgis.com"}),(0,s.jsx)("link",{rel:"preconnect",href:"https://static.arcgis.com"})]});var Ce=e=>{var t,i,o,a,n,l,d,p,c,u;const{itemType:m,itemDetails:g,publishedDate:f,host:y,config:x,authorTrackingConfig:v}=e,b=v&&(0,w.St)(v).isValidAnalyticsConfig,I=x.ESRI_MARKETING_ANALYTICS&&((g.typeKeywords??[]).includes(je.hH)||"string"===typeof g.orgId&&x.ESRI_MARKETING_ANALYTICS.orgIds.includes(g.orgId))?x.ESRI_MARKETING_ANALYTICS.scriptSrc:void 0,{requestNextRouteChangeWithFullPageLoad:S,getUrlFromRouteDef:k}=(0,Z.Gr)();(0,r.useEffect)((()=>{(b||"undefined"!==typeof I)&&S()}),[b,I,S]);const P=(0,Te.Z)(!0),j=`${y?"https://"+y:(0,Se.o)({siteUrl:x.SITE_URL,isComponentMounted:P})}`,A=(0,ke.Sg)({portalHost:x.PORTAL_HOST,itemDetails:g,fallbackUrl:`${j}${(0,Ae.Zr)(x.BASE_URL)}`,shouldIgnoreDPR:!0,returnOriginalAspectRatio:!0}),D=(0,T.G)(g),M=(null===(i=D)||void 0===i||null===(t=i.metaProperties)||void 0===t?void 0:t.title)?(0,ne.dW)(null===(a=D)||void 0===a||null===(o=a.metaProperties)||void 0===o?void 0:o.title):(0,ne.dW)(e.title),C=(0,ne.dW)(e.author),$=(null===(l=D)||void 0===l||null===(n=l.metaProperties)||void 0===n?void 0:n.description)?(0,ne.dW)(null===(p=D)||void 0===p||null===(d=p.metaProperties)||void 0===d?void 0:d.description):g.snippet?(0,ne.dW)(g.snippet):g.description?(0,ne.dW)(g.description):"",L=k({route:"viewer",itemType:m,itemId:g.id}),_=(null===(c=g.typeKeywords)||void 0===c?void 0:c.includes(Pe.L7))||!(0,ke._$)(g);return(0,s.jsxs)(h(),{children:[(0,s.jsx)("title",{children:M},"title"),(0,s.jsx)("meta",{name:"author",content:C},"author"),(0,s.jsx)("meta",{property:"article:published_time",content:f.toISOString()},"publishedDate"),(0,s.jsx)("link",{rel:"canonical",href:L}),(0,s.jsx)("link",{rel:"alternate",type:"application/json+oembed",href:`${j}/oembed?url=${encodeURIComponent(L)}&format=json`,title:M}),(0,s.jsx)("link",{rel:"alternate",type:"text/xml+oembed",href:`${j}/oembed?url=${encodeURIComponent(L)}&format=xml`,title:M}),(0,s.jsx)(Me,{}),("undefined"!==typeof g.robots||_)&&(0,s.jsx)("meta",{name:"robots",content:_?"noindex, nofollow":"function"===typeof(null===(u=g.robots)||void 0===u?void 0:u.join)?g.robots.join(","):"noindex, nofollow"}),(0,s.jsx)("meta",{property:"og:title",content:M},"og:title"),(0,s.jsx)("meta",{property:"og:description",content:$},"og:description"),(0,s.jsx)("meta",{property:"og:url",content:L},"og:url"),(0,s.jsx)("meta",{property:"og:image",content:A},"og:image"),(0,s.jsx)("meta",{name:"twitter:creator",content:C},"twitter:creator"),(0,s.jsx)("meta",{name:"twitter:url",content:L},"twitter:url"),(0,s.jsx)("meta",{name:"twitter:title",content:M},"twitter:title"),(0,s.jsx)("meta",{name:"twitter:description",content:$},"twitter:description"),(0,s.jsx)("meta",{name:"twitter:image",content:A},"twitter:image"),(0,s.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:`${De(L,A,new Date(g.created).toISOString(),f.toISOString(),C,M,$,j,x)}`}}),I&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("script",{dangerouslySetInnerHTML:{__html:`(function(){window.dataLayer = Object.assign({}, window.dataLayer, {pageTitle: 'StoryMap: ${g.owner}: ' + document.title, pageName: 'StoryMap: ' + document.title, pageType: 'StoryMaps', pageSubType: 'StoryMap', domain: window.location.host, language: 'en',countryCode: 'us'});})()`}}),(0,s.jsx)("script",{src:I,async:!0})]})]})},$e=i(1880),Le=i(33037),_e=i(45530),Re=i(37916);var Ze=e=>(0,s.jsx)(Y.ZP,{type:"secondary",className:e.className,onClick:()=>window.history.back(),children:(0,s.jsx)(n.Z,{id:"page.error.back"})});class Ee extends r.PureComponent{render(){return(0,s.jsx)(Y.ZP,{className:this.props.className,onClick:this.print,children:(0,s.jsx)(n.Z,{id:"common.print"})})}constructor(...e){super(...e),this.print=()=>{b.Z.trackEvent(b.Z.Category.Viewer,b.Z.Action.Viewer_Print),window.print()}}}var Be=Ee;var He=()=>{const e={styles:(0,s.jsx)(a(),{id:"670c5ea701ffc9da",dynamic:[g.default.spacing.xs],children:`.side-margins.__jsx-style-dynamic-selector{margin:0 ${g.default.spacing.xs}}`}),className:a().dynamic([["670c5ea701ffc9da",[g.default.spacing.xs]]])};return(0,s.jsxs)("div",{className:a().dynamic([["8958a3e2ea8738ad",[g.default.spacing.lg,g.default.spacing.xs,f.K.RTL]]])+" basic-wrapper",children:[(0,s.jsxs)("div",{className:a().dynamic([["8958a3e2ea8738ad",[g.default.spacing.lg,g.default.spacing.xs,f.K.RTL]]])+" print-wrapper",children:[(0,s.jsx)(Be,{className:`side-margins ${e.className}`}),(0,s.jsx)(Ze,{className:`side-margins ${e.className}`})]}),(0,s.jsx)(a(),{id:"8958a3e2ea8738ad",dynamic:[g.default.spacing.lg,g.default.spacing.xs,f.K.RTL],children:`.basic-wrapper.__jsx-style-dynamic-selector{position:relative;display:none}@media screen{.basic-wrapper.__jsx-style-dynamic-selector{display:block}}.print-wrapper.__jsx-style-dynamic-selector{position:absolute;top:${g.default.spacing.lg};left:100%;display:grid;grid-gap:${g.default.spacing.xs}}${f.K.RTL} .print-wrapper.__jsx-style-dynamic-selector{left:unset;right:100%}`}),e.styles]})};var Oe=e=>{const{vertical:t}=(0,E.YO)(),{theme:i}=(0,m.Fj)(),o=p()("viewer-main",je.MH,e.mainClassName,{"device-preview":"preview"===e.mode});return(0,s.jsxs)(Re.Z,{className:p()({"inline-story":e.isInlineStory}),children:[e.viewerHeader,e.printMode&&(0,s.jsx)(He,{}),(0,s.jsx)("main",{className:a().dynamic([["6e2f67f06aa6f1b1",[g.default.print.pageWidthLetter,g.default.print.backgroundColor]],["56fd166d73c70d2",[t,i.colors.focus,t]]])+" "+(o||""),children:e.children}),(0,s.jsx)(a(),{id:"56fd166d73c70d2",dynamic:[t,i.colors.focus,t],children:`.viewer-main.__jsx-style-dynamic-selector{min-height:-webkit-calc(100vh - ${t});min-height:-moz-calc(100vh - ${t});min-height:calc(100vh - ${t})}.viewer-main.device-preview.__jsx-style-dynamic-selector{min-height:0}*:focus{outline-color:${i.colors.focus}}body.print .viewer-main.__jsx-style-dynamic-selector{min-height:0}@supports(height:1svh){.viewer-main.__jsx-style-dynamic-selector{min-height:-webkit-calc(100svh - ${t});min-height:-moz-calc(100svh - ${t});min-height:calc(100svh - ${t})}}`}),(0,s.jsx)(a(),{id:"6e2f67f06aa6f1b1",dynamic:[g.default.print.pageWidthLetter,g.default.print.backgroundColor],children:`body.print{width:${g.default.print.pageWidthLetter};margin:0 auto}body.print .page-container{background:${g.default.print.backgroundColor}}`})]})};class ze extends r.PureComponent{constructor(e){var t;super(e),this.setAuthorTrackerFromConfig=()=>{var e;if(this.trackingDetails=this.getAuthorTrackerDetails(),this.trackingType=null===(e=this.trackingDetails)||void 0===e?void 0:e.type,void 0!==this.trackingDetails&&!this.state.hasActiveAuthorTracker){w.YX.setup({portal:this.props.portalSelfResponse,authorTrackingConfig:this.trackingDetails});try{w.YX.instance.startupTracker(),this.setState({hasActiveAuthorTracker:!0})}catch(t){this.setState({hasActiveAuthorTracker:!1}),console.error("Error starting author tracker",t)}}},this.getItemViewerHeader=()=>{const e=this.props.storyItem.getItemPublishStatus(),t=this.props.storyItem.itemSharingLevel,i=this.props.storyItem.itemDetails&&"embedded-preview"!==this.props.mode&&"preview"!==this.props.mode&&!this.props.storyItem.itemDetails.origin&&("admin"===this.props.storyItem.itemDetails.itemControl||"update"===this.props.storyItem.itemDetails.itemControl),o={...this.props,storyId:this.props.storyItem.itemId,title:this.state.title,isOrgItem:this.props.storyItem.isOrgItem,itemOwner:this.props.storyItem.itemOwner,storyType:this.props.itemType,publishStatus:e,sharingLevel:t,canEdit:i,areSocialIconsHidden:this.state.areSocialIconsHidden,appLogo:this.props.appLogo,shouldShowSkipLink:!0,onSkipLink:this.onSkipLink};switch(this.props.itemType){case N.o.Story:return(0,s.jsx)($e.Z,{...o,onTitleClicked:this.resetItemBlock});case N.o.Collection:return(0,s.jsx)(ae.Z,{...o,getItemHref:this.getItemHref});case N.o.Briefing:return(0,s.jsx)(se.Z,{...o});case N.o.Frame:return(0,s.jsx)(s.Fragment,{});default:throw Error("No story item type provided")}},this.getBannerStringId=()=>this.props.itemType===N.o.Frame?"frames.preview.banner":"common.banner.viewDraftStory.mobile",this.getItemHref=e=>{var t;return null===(t=this.itemBlock)||void 0===t?void 0:t.do("getItemUrl",e)},this.renderBanner=e=>(0,s.jsxs)(r.Fragment,{children:["fullscreen-preview"===e&&(!this.props.isViewportMinWidth("large")||this.props.itemType===N.o.Frame)&&(0,s.jsx)("div",{className:a().dynamic([["3da9797c8039bd01",[this.props.appOffset.top]]])+" draft-preview-banner",children:(0,s.jsx)(u.Z,{size:"small",title:(0,s.jsx)(n.Z,{id:this.getBannerStringId()}),backgroundColor:this.props.websiteDesign.theme.colors.interactiveDefault,textColor:this.props.websiteDesign.theme.colors.labelPrimaryReverse,closeBtnColor:this.props.websiteDesign.theme.colors.labelPrimaryReverse,closeButtonLabel:this.props.intl.formatMessage({id:"common.close"})})}),(0,s.jsx)(a(),{id:"3da9797c8039bd01",dynamic:[this.props.appOffset.top],children:`.draft-preview-banner.__jsx-style-dynamic-selector{position:absolute;top:${this.props.appOffset.top};left:0;width:100%;z-index:1}body.print .draft-preview-banner.__jsx-style-dynamic-selector{display:none}body.frame{-webkit-touch-callout:none;-webkit-user-select:none}`})]}),this.renderBody=e=>"preview"===e&&"fullscreen"!==this.state.previewDevice?(0,s.jsx)(pe,{device:this.state.previewDevice,orientation:this.state.previewOrientation,onOrientationChange:this.onOrientationChange,query:this.props.query,...this.props.additionalDevicePreviewProps??{}}):(0,s.jsxs)(s.Fragment,{children:[this.state.ui,this.renderBanner(e)]}),this.onOrientationChange=()=>{const e="landscape"===this.state.previewOrientation?"portrait":"landscape";this.setState({previewOrientation:e})},this.onPreviewDeviceChange=e=>{if(e){const t={previewDevice:e};"phone"===e?(Object.assign(t,{previewOrientation:"portrait"}),b.Z.trackEvent(b.Z.Category.Preview,b.Z.Action.Preview_Device_Phone)):"tablet"===e&&(Object.assign(t,{previewOrientation:"landscape"}),b.Z.trackEvent(b.Z.Category.Preview,b.Z.Action.Preview_Device_Tablet)),this.setState(t,(()=>{var t,i;null===(t=(i=this.props).onPreviewDeviceChange)||void 0===t||t.call(i,e)}))}},this.resetItemBlock=()=>{var e;null===(e=this.itemBlock)||void 0===e||e.do("reset")},this.getAuthorTrackerDetails=()=>{const e=!this.props.environment.isPortal||this.props.featureDecisions.canHaveAuthorAnalytics,t=(0,Le.C5)(this.props.storyItem,e,this.props.printMode);if("view"!==this.props.mode||!t)return;return!t||!t.consentMessage||this.state.hasUserAcceptedAuthorAnalytics?t:void 0},this.onAuthorAnalyticsConsentMessageAccepted=()=>{this.setState({isAuthorAnalyticsConsentMessageShowing:!1,hasUserAcceptedAuthorAnalytics:!0},(()=>{this.setAuthorTrackerFromConfig()}))},this.onAuthorAnalyticsConsentMessageDismissed=()=>{this.setState({isAuthorAnalyticsConsentMessageShowing:!1})},this.jumpToBlock=()=>{let e=0,t=0,i=document.body.offsetHeight;const s=setInterval((async()=>{t++;const o=document.body.offsetHeight;var a;(o===i?e++:(i=o,e=0),e>=5||t>=25)&&(clearInterval(s),(0,Le.tc)(),this.state.linkedBlockId&&await(null===(a=this.itemBlock)||void 0===a?void 0:a.do("jumpToBlock",this.state.linkedBlockId)))}),100)},this.getHasDocumentLoaded=()=>"undefined"!==typeof document&&"complete"===document.readyState,this.onWindowLoaded=()=>{this.setState({hasPageLoaded:!0}),this.state.linkedBlockId&&this.state.hasItemRendered&&this.jumpToBlock()},this.getBylineFromStoryItemData=(e,t)=>{if(t===N.o.Story){const t=e.nodes[e.root];if(!t.children)return"";for(const s of t.children){const t=e.nodes[s];var i;if(t&&"storycover"===t.type)return null===(i=t.data)||void 0===i?void 0:i.byline}}else{if(t!==N.o.Collection){if(t===N.o.Frame)return"";if(t===N.o.Briefing)return"";throw new Error("only call getBylineFromStoryItemData for gemini items")}for(const t of Object.values(e.nodes)){var s;if(t&&"collection-cover"===t.type)return null===(s=t.data)||void 0===s?void 0:s.byline}}return""},this.onSkipLink=async()=>{var e;const t=null===(e=this.itemBlock)||void 0===e?void 0:e.do("getSkipLinkId");var i;t&&await(null===(i=this.itemBlock)||void 0===i?void 0:i.do("jumpToBlock",t))},this.state={ui:void 0,viewerHeaderTheme:"light",title:(null===(t=this.props.storyItem.itemDetails)||void 0===t?void 0:t.title)||"",areSocialIconsHidden:!1,previewDevice:"fullscreen",previewOrientation:"landscape",isMounted:!1,isAuthorAnalyticsConsentMessageShowing:!1,hasUserAcceptedAuthorAnalytics:!1,hasActiveAuthorTracker:!1,hasPageLoaded:this.getHasDocumentLoaded(),linkedBlockId:this.props.canJumpToLinkedBlock&&!this.props.printMode?(0,Le.g2)():void 0,hasItemRendered:!1}}componentDidMount(){if(this.setState({isMounted:!0}),this.state.linkedBlockId){this.getHasDocumentLoaded()?this.onWindowLoaded():window.addEventListener("load",this.onWindowLoaded)}const e="view"===this.props.mode?this.props.storyItem.itemData:this.props.storyItem.itemDraftData,t={shouldHideItemActions:this.props.storyItem.itemId===_e.BD||this.props.shouldHideItemActions||!!this.props.printMode||"view"!==this.props.mode,printMode:this.props.printMode,viewMode:this.props.mode,lazy:!this.props.printMode,storyItem:this.props.storyItem,config:this.props.config,featureDecisions:this.props.featureDecisions,environment:this.props.environment,toast:this.props.toast,portalSelfResponse:this.props.portalSelfResponse,authManager:this.props.authManager,getIntl:()=>this.props.intl,getAppOffset:()=>this.props.appOffset,getStoryOffset:()=>this.props.storyOffsetContext,getStoryRouting:()=>this.props.storyRouting,...this.props.additionalBuildOptions??{},root:{initialThemeItemInfo:this.props.initialThemeItemInfo},canCopyLinks:!this.props.isInlineStory&&!(0,I.XU)()};let i=!1;{const e=window.location.search;e.includes("lazy=false")&&Object.assign(t,{lazy:!1}),e.includes("lab=true")&&(i=!0,Object.assign(t,{lab:!0})),document&&document.body&&this.props.printMode&&document.body.classList.add("print",this.props.printMode),document&&document.body&&this.props.itemType===N.o.Frame&&document.body.classList.add("frame")}(0,P.J_)({data:e,mode:"viewer",context:{...t},registry:(0,R.J)({featureDecisions:this.props.featureDecisions,includeLabItems:i})}).then((e=>{this.itemBlock=e;const t=this.itemBlock.do("getStoryTheme");return this.setState({viewerHeaderTheme:t.websiteThemeFlavor,title:this.itemBlock.do("getCoverTitle"),areSocialIconsHidden:this.itemBlock.do("isSocialIconsHidden"),coverData:this.itemBlock.do("getCoverData")}),this.itemBlock.render()})).then((e=>{var t,i;this.setAuthorTrackerFromConfig(),this.setState({ui:e,hasItemRendered:!0,isAuthorAnalyticsConsentMessageShowing:"view"===this.props.mode&&!this.props.printMode&&!!(null===(t=this.itemBlock)||void 0===t?void 0:t.do("getAuthorAnalytics"))&&!!(null===(i=this.itemBlock)||void 0===i?void 0:i.do("getAuthorAnalytics")).consentMessage}),this.state.linkedBlockId&&this.state.hasPageLoaded&&this.jumpToBlock()})).then((()=>{if("view"===this.props.mode&&this.props.storyItem.itemId!==_e.BD)try{(0,B.Az)({itemId:this.props.storyItem.itemId,portalHost:this.props.config.PORTAL_HOST,authManager:this.props.authManager,customTracker:this.props.itemViewTracker})}catch(e){}})).catch((e=>{b.Z.trackEvent(b.Z.Category.Viewer,b.Z.Action.Story_Render_Error,this.props.storyItem.itemId),this.props.redirectOnLoadError({config:this.props.config,signInUrl:this.props.signInUrl,authManager:this.props.authManager})}))}componentWillUnmount(){this.setState({isMounted:!1}),window.removeEventListener("load",this.onWindowLoaded)}render(){var e,t,i,o,n,l;const d=null===(e=this.itemBlock)||void 0===e?void 0:e.do("getMetaSettings"),c=(0,Le.RC)({itemType:this.props.itemType,title:(null===(t=d)||void 0===t?void 0:t.title)??this.state.title,formatMessage:this.props.intl.formatMessage});let u=this.props.mode;"preview"!==this.props.mode||"fullscreen"!==this.state.previewDevice&&this.props.isViewportMinWidth("large")||(u="fullscreen-preview");const y=!this.props.printMode&&("preview"===this.props.mode||"fullscreen-preview"===this.props.mode&&this.props.isViewportMinWidth("large")),x=this.props.shouldShowViewerHeader&&("preview"!==this.props.mode||"preview"===this.props.mode&&"fullscreen"===this.state.previewDevice)?(0,s.jsx)(m.tT,{defaultTheme:this.state.viewerHeaderTheme,isStoryThemeDependent:!0,children:this.getItemViewerHeader()}):null,v=(null===(o=(0,T.G)(this.props.storyItem.itemDetails))||void 0===o||null===(i=o.metaProperties)||void 0===i?void 0:i.description)||this.props.storyItem.itemDetails.snippet,w={styles:(0,s.jsx)(a(),{id:"9afa34b86d540485",dynamic:[this.props.websiteDesign.theme.colors.backgroundPrimary],children:`.briefing-viewer-main.__jsx-style-dynamic-selector{background-color:${this.props.websiteDesign.theme.colors.backgroundPrimary}}`}),className:a().dynamic([["9afa34b86d540485",[this.props.websiteDesign.theme.colors.backgroundPrimary]]])};return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(oe.Z,{children:c}),v&&(0,s.jsx)(h(),{children:(0,s.jsx)("meta",{name:"description",content:v,className:a().dynamic([["2250383af5cd1082",[this.props.appOffset.bottom,g.default.spacing.md,f.K.RTL]]])},"description")}),(this.props.itemType===N.o.Story||this.props.itemType===N.o.Briefing||this.props.itemType===N.o.Frame)&&(0,s.jsx)(L.Z,{}),this.props.storyItem.itemDetails&&this.props.storyItem&&this.props.storyItem.itemData&&this.props.storyItem.getItemPublishDate()&&(0,s.jsx)(Ce,{title:c,itemType:this.props.itemType,itemDetails:this.props.storyItem.itemDetails,author:this.getBylineFromStoryItemData(this.props.storyItem.itemData,this.props.itemType),publishedDate:this.props.storyItem.getItemPublishDate(),host:this.props.host,config:this.props.config,authorTrackingConfig:this.getAuthorTrackerDetails()}),(0,s.jsx)(z.ZP.Provider,{value:this.props.storyItem,children:(0,s.jsx)(W.UV,{initialQuery:this.props.query,children:(0,s.jsx)(O.b,{children:(0,s.jsx)(_.M2,{storyItem:this.props.storyItem,children:(0,s.jsxs)(H.H9,{children:[this.state.isAuthorAnalyticsConsentMessageShowing&&(0,s.jsx)($,{onAllowClicked:this.onAuthorAnalyticsConsentMessageAccepted,onDismissClicked:this.onAuthorAnalyticsConsentMessageDismissed,message:(null===(n=null===(l=this.itemBlock)||void 0===l?void 0:l.do("getAuthorAnalytics"))||void 0===n?void 0:n.consentMessage)??""}),(0,s.jsxs)(Oe,{...this.props,viewerHeader:x,mode:u,printMode:this.props.printMode,isInlineStory:this.props.isInlineStory,mainClassName:this.props.itemType===N.o.Briefing?p()(w.className,"briefing-viewer-main"):void 0,children:[(0,s.jsx)(ie,{onScrolledToBottom:this.resetItemBlock,collectionBlock:this.props.itemType===N.o.Collection?this.itemBlock:void 0}),y&&this.props.isViewportMinWidth("large")&&this.state.isMounted&&this.props.itemType!==N.o.Frame&&(0,s.jsx)("div",{className:a().dynamic([["2250383af5cd1082",[this.props.appOffset.bottom,g.default.spacing.md,f.K.RTL]]])+" preview-controls-container",children:(0,s.jsx)(m.tT,{defaultTheme:"light",children:(0,s.jsx)(Ie,{onDeviceChange:this.onPreviewDeviceChange,device:this.state.previewDevice,itemType:this.props.itemType,itemId:this.props.storyItem.itemId,canShowNudge:this.props.canShowPreviewControlsNudge})})}),this.renderBody(u),this.props.footerBanner]})]})})})})}),(0,s.jsx)(a(),{id:"2250383af5cd1082",dynamic:[this.props.appOffset.bottom,g.default.spacing.md,f.K.RTL],children:`.preview-controls-container.__jsx-style-dynamic-selector{position:fixed;z-index:98;bottom:-webkit-calc(${this.props.appOffset.bottom} + ${g.default.spacing.md});bottom:-moz-calc(${this.props.appOffset.bottom} + ${g.default.spacing.md});bottom:calc(${this.props.appOffset.bottom} + ${g.default.spacing.md});right:7.2rem}${f.K.RTL} .preview-controls-container.__jsx-style-dynamic-selector{right:unset;left:7.2rem}`}),this.props.itemType===N.o.Briefing&&w.styles]})}}var Ne=(0,m.EL)((0,S.Df)((0,l.ZP)((0,Z.Jy)((0,U.F)((0,k.oh)((0,E.Jh)((0,y.d2)((0,x.ZP)((0,v.VO)(ze))))))))))},45530:function(e,t,i){i.d(t,{BD:function(){return o},kS:function(){return l},nt:function(){return n}});var s=i(73927);const o="sample32charactersvaliditemidaaa",a=e=>{var t;const i=Date.now();return{id:o,owner:"StoryMaps Team",created:i,modified:i,title:(null===(t=e)||void 0===t?void 0:t({id:"component.themeEditor.storyHeaderText"}))??"",type:s.Cs,typeKeywords:["arcgis-storymaps",`smdraftresourceid:${s.AY}0.json`,`smpublisheddate:${i}`,"smstatuspublished","smversiondraft:20.27.0","smversionpublished:20.27.0","StoryMap","Web Application"],tags:[""],numViews:0,size:0}},r=e=>{let{formatMessage:t,baseUrl:i,siteUrl:s,productName:o,baseThemeId:a}=e;var r;const n=e=>{let[i]=e;var s;return(null===(s=t)||void 0===s?void 0:s({id:`component.themePreviewSampleStory.${i}`}))??""};return{root:"n-lMEvw3",nodes:{"n-ZEqBEg":{type:"storycover",data:{type:"minimal",title:n`storycover.title`,summary:n`storycover.summary`,byline:o,titlePanelPosition:"start"}},"n-YKldSA":{type:"navigation",data:{links:[{nodeId:"n-VMrERe"}]},config:{isHidden:!0}},"n-EDAcop":{type:"text",data:{text:n`text1`,type:"paragraph"}},"n-erhBAh":{type:"text",data:{text:n`text2`,type:"paragraph"}},"n-PHc2cM":{type:"button",data:{text:n`button.text`,link:""}},"n-VMrERe":{type:"text",data:{type:"h2",text:n`text3`}},"n-lfXBaT":{type:"text",data:{text:n`text4`,type:"paragraph"}},"n-links":{type:"text",data:{text:n`link`,type:"paragraph"}},"n-vbQaVc":{type:"text",data:{text:n`text5`,type:"quote"}},"n-Y2phK6":{type:"text",data:{text:n`text6`,type:"h3"}},"n-CKO4Ak":{type:"text",data:{text:n`text7`,type:"paragraph"}},"n-expressmap":{type:"expressmap",data:{map:"r-expressmap",alt:"",caption:n`expressmap.caption`},config:{size:"standard"}},"n-6bhWAJ":{type:"text",data:{type:"paragraph",text:n`text8`}},"n-4Dsx7p":{type:"separator"},"n-EcdqDK":{type:"audio",data:{audio:"r-j7OSzQ",caption:n`audio.caption`}},"n-7KLTO8":{type:"text",data:{text:n`text9`,type:"paragraph"}},"n-r7trnc":{type:"embed",data:{url:s+i,embedType:"link",title:o,description:(null===(r=t)||void 0===r?void 0:r({id:"page.index.subtitle"}))??"",thumbnailUrl:`${i}/static/images/social-sharing-card.jpeg?v=22.15`,providerUrl:s,caption:o,display:"card"}},"n-8CSjqa":{type:"text",data:{text:n`text10`,type:"h4"}},"n-1GjFLq":{type:"text",data:{text:n`text11`,type:"paragraph"}},"n-80Orlw":{type:"attribution",data:{content:n`attribution.content`,attribution:n`attribution.attribution`}},"n-TiLsTS":{type:"credits",children:["n-8CSjqa","n-1GjFLq","n-80Orlw"]},"n-lMEvw3":{type:"story",data:{storyTheme:"r-82O3KC"},children:["n-ZEqBEg","n-YKldSA","n-EDAcop","n-erhBAh","n-PHc2cM","n-VMrERe","n-lfXBaT","n-links","n-vbQaVc","n-Y2phK6","n-CKO4Ak","n-expressmap","n-4Dsx7p","n-6bhWAJ","n-EcdqDK","n-7KLTO8","n-r7trnc","n-TiLsTS"]}},resources:{"r-expressmap":{type:"expressmap",data:{src:`${i}/static/storymaps-builder/expressmaps/theme_preview_sample_expressmap.json`,provider:"uri"}},"r-j7OSzQ":{type:"audio",data:{src:`${i}/static/storymaps-builder/audio/theme_preview_sample_audio.wav`,provider:"uri"}},"r-82O3KC":{type:"story-theme",data:{themeId:a,themeBaseVariableOverrides:{}}}}}};var n;!function(e){e.AUDIO="n-EcdqDK",e.BUTTON="n-PHc2cM",e.SEPARATOR="n-4Dsx7p",e.STORYCOVER="n-ZEqBEg",e.QUOTE="n-vbQaVc",e.LINK="n-links",e.EXPRESSMAP="n-expressmap"}(n||(n={}));const l=e=>({id:o,draftData:r(e),itemDetails:a(e.formatMessage)})},7073:function(e,t,i){i.d(t,{C:function(){return a},G:function(){return o}});var s=i(2784);const o=(0,s.createContext)({briefingDisplay:{currentIndex:0,totalNumberOfSlides:0,isStoryItemOutlineShowing:!1},updateBriefingDisplay:()=>{}}),a=()=>(0,s.useContext)(o)},82770:function(e,t,i){i.d(t,{W:function(){return s}});const s=(0,i(2784).createContext)({collectionData:{titlesArray:[],updateCollectionData:()=>{}},collectionDisplay:{currentIndex:-1,isCoverShowing:!0,isItemViewTransitionComplete:!1,updateCollectionDisplay:()=>{}}})},72959:function(e,t,i){i.d(t,{Od:function(){return a}});i(52322);var s=i(2784);const o=(0,s.createContext)({translateContentIntoLocale:()=>{},submitTranslationFeedback:()=>{},allSupportedLanguages:[]}),a=()=>(0,s.useContext)(o)},54272:function(e,t,i){i.d(t,{e:function(){return a},k:function(){return o}});var s=i(2784);const o=(0,s.createContext)({toggleDesignPanelHook:()=>{},updateStoryContext:()=>{},storyLogo:{src:"https://example.org/logo.png",link:"https://example.org",alt:"alt"}}),a=()=>(0,s.useContext)(o)},23559:function(e,t,i){i.d(t,{b:function(){return r}});var s=i(52322),o=i(2784),a=i(54272);const r=e=>{const[t,i]=(0,o.useState)({});return(0,s.jsx)(a.k.Provider,{value:{...t,updateStoryContext:e=>{i((t=>({...t,...e})))}},children:e.children})}},66982:function(e,t,i){i.d(t,{B:function(){return s}});const s=(0,i(2784).createContext)({updateStoryOffsetContext:()=>{},storyOffset:{navBarHeight:"0rem"}})},81736:function(e,t,i){i.d(t,{Db:function(){return m},Mq:function(){return h},NH:function(){return u},Yx:function(){return f},kE:function(){return g},kz:function(){return c}});var s=i(52322),o=i(2784),a=i(69378),r=i(58204),n=i(39613),l=i(28184),d=i(57348),p=i(72959);const c=e=>{var t,i;return null===(i=e.nodes[e.root])||void 0===i||null===(t=i.config)||void 0===t?void 0:t.storyLocale},h=async e=>{{const{setLocale:t}=await Promise.all([i.e(36234),i.e(53765),i.e(4516)]).then(i.bind(i,4516));t(e??window.document.documentElement.lang??"en")}},u=async(e,t)=>{var i,s,o;const r=t||(null===(o=window)||void 0===o||null===(s=o.document)||void 0===s||null===(i=s.documentElement)||void 0===i?void 0:i.lang)||"en-us",l=`${(0,n.Zl)(e)}/portals/regions?f=json&culture=${r}`;return await(0,a.WY)(l)},m=e=>e.map(((e,t)=>({id:t,content:e.localizedName,searchModifier:"",iSearchOptions:{categories:`/Region/${e.region}`}}))),g=e=>{var t;const{authManager:i}=(0,r.Pc)(),s=(0,l.ZR)(),{allSupportedLanguages:a}=(0,p.Od)(),[c,h]=(0,o.useState)(),u=(0,n.Zl)(s.PORTAL_HOST,i),m=(0,o.useMemo)((()=>{var t,i;const s=(null===(i=e)||void 0===i||null===(t=i.supportedLocales)||void 0===t?void 0:t.map((e=>(0,d.dA)(e,a))))??[];return new Set(s)}),[null===(t=e)||void 0===t?void 0:t.supportedLocales,a]);(0,o.useEffect)((()=>{(async()=>{if(u)try{const e=await(0,d.hN)(u);h(e)}catch(e){console.error(e)}})()}),[u]);return(0,o.useMemo)((()=>{if(!c)return;if(!m.size)return c;return c.filter((e=>{const t=(0,d.dA)(e.culture,a);return m.has(t)}))}),[c,m,a])},f=(e,t)=>i=>{const o=g(t);return(0,s.jsx)(e,{portalLanguages:o,...i})}},56102:function(e,t,i){i.d(t,{J:function(){return s}});const s=e=>"string"===typeof e&&/^[a-zA-Z\d]{32}$/g.test(e)},84094:function(e,t,i){i.d(t,{z:function(){return s}});const s=(e,t,i)=>i.indexOf(e)===t},93564:function(e,t,i){i.d(t,{A:function(){return I},t:function(){return S}});var s=i(63789),o=i(4628),a=i(66831),r=i(36871),n=i(81736),l=i(52405),d=i(92427),p=i(45530),c=i(4479),h=i(83245),u=i(96934),m=i(57348),g=i(23038),f=i(77468),y=i(43746),x=i(54058),v=i(69318),w=i(29179),b=i(68658);const I=async e=>{const{id:t,authManager:i,config:p,ctx:c,itemType:h,translationOptions:u,shouldRedirect:x}=e;if(h===s.o.Frame){var w,I,S;if(!p.ENABLE_FRAMES)return{redirect:{asPath:`${p.BASE_URL}/error`},success:!1};if(null===(S=c)||void 0===S||null===(I=S.req)||void 0===I||null===(w=I.url)||void 0===w?void 0:w.includes("test"))return P(p,t)}if(!t)throw new Error(`no ${h} id`);if("undefined"!==typeof c){var k,j;const{res:e}=c;null===(j=e)||void 0===j||null===(k=j.setHeader)||void 0===k||k.call(j,"Vary","Cookie")}const A={itemId:t,authManager:i,portalHost:p.PORTAL_HOST},D={...A,type:h,config:p};try{var M,C,$,L,_,R;let[s,w]=await Promise.all([o.ZP.fetchItemDetails(A),o.ZP.fetchPublishedItemData(D)]);if(!(0,a.mT)(s,h)){const e=(0,a.HL)(s);throw new r.Z({type:"item-not-supported-on-route",itemType:e})}let I=(0,n.kz)(w);const T=(null===(M=u)||void 0===M?void 0:M.locale)?(0,m.dA)(u.locale,u.supportedLanguages,u.fallbackLanguage):void 0;T&&(null===($=(0,g.G)(s))||void 0===$||null===(C=$.translations)||void 0===C?void 0:C[T])&&(null===(L=u)||void 0===L?void 0:L.autoTranslationTypeKeyword)&&(0,f._$)({typeKeywords:s.typeKeywords,typeKeywordId:u.autoTranslationTypeKeyword})?(I=I?u.locale:void 0,w=await o.ZP.fetchPublishedItemData({...D,language:T})):T&&(null===(_=u)||void 0===_?void 0:_.locale)&&(null===(R=I)||void 0===R?void 0:R.startsWith(T))&&(I=u.locale);const S=await(0,l.ir)({storyItemData:w,authManager:i,portalHost:p.PORTAL_HOST});if((0,y.ZX)(s)||(0,f.bk)(s)&&("admin"===s.itemControl||"update"===s.itemControl)){const e=(0,d.N)(h),i=`/${e}/edit?id=${t}`,s=`${p.BASE_URL}/${e}/${t}/edit`;return x&&(0,v.j)({ctx:c,href:i,asPath:s}),{redirect:{asPath:s},success:!1}}if("public"!==s.access&&i)try{if("user-unauthorized"===await(0,b.T)({authManager:i,config:p}))throw new Error("user-unauthorized")}catch(E){if(x)throw E;return{redirect:{asPath:`${p.BASE_URL}/error`},success:!1}}let k="";if("undefined"!==typeof c){var Z;const{req:t,res:i}=c;i&&"function"===typeof i.setHeader&&("public"===s.access?i.setHeader("Cache-Control",`public, max-age=${e.skipCache?0:p.CACHE_MAX_AGE}`):i.setHeader("Cache-Control",`private, max-age=${e.skipCache?0:p.NON_PUBLIC_CACHE_MAX_AGE}`)),k=(null===(Z=t)||void 0===Z?void 0:Z.headers.host)||""}return{id:t,itemDetails:s,publishedData:w,host:k,initialThemeItemInfo:S,...I?{pageLocale:I}:{},success:!0}}catch(B){return T(B,e)}},T=(e,t)=>{const{id:i,authManager:o,config:a,ctx:n,signInUrl:l,itemType:p,shouldRedirect:c}=t;if(!e||!e.code){if("string"===typeof e.message&&e.message.search(`items/${i}/data`)>=0&&"invalid-json"===e.type){const t=p===s.o.Collection?"edit":"preview",o=(0,d.N)(p);return c&&(0,v.j)({ctx:n,href:`/${o}/${t}?id=${i}`,asPath:`${a.BASE_URL}/${o}/${i}/${t}`}),{redirect:{asPath:`${a.BASE_URL}/${o}/${i}/${t}`},error:e,success:!1}}if("string"===typeof e.message&&"user-unauthorized"===e.message)return c&&(0,v.j)({ctx:n,href:`/error?errType=unsupported-account&itemType=${p}`,asPath:`${a.BASE_URL}/error?errType=unsupported-account&itemType=${p}`}),{redirect:{asPath:`${a.BASE_URL}/error?errType=unsupported-account&itemType=${p}`},error:e,success:!1};if("string"===typeof e.message&&"item-not-supported-on-route"===e.message&&i){const s=t.convertRoute({routeDef:{route:"viewer",itemType:e.itemType,itemId:i},featureDecisions:{canAccessExternalUrls:!1},config:a,authManager:o}),r="error?errType=item-not-supported-on-route`",l=`${a.BASE_URL}/${r}`;return c&&(0,v.j)({ctx:n,href:s.href.pathname||s.href||r,asPath:s.as||l}),{redirect:{asPath:s.as||l},success:!1}}return c&&(0,v.j)({ctx:n,href:`/error?itemType=${p}`,asPath:`${a.BASE_URL}/error?itemType=${p}`}),{redirect:{asPath:`${a.BASE_URL}/error?itemType=${p}`},error:e,success:!1}}try{return(0,w.q)({ctx:n,authManager:o,signInUrl:l,error:e,config:a}),{redirect:{asPath:""},error:e,success:!1}}catch(h){throw new r.Z(h)}},S=async e=>{const{id:t,authManager:i,config:s,ctx:o,signInUrl:h,itemType:u,shouldRedirect:m}=e;if(!t)throw new Error(`no ${u} id`);if(t===p.BD)return k(e);const g={itemId:t,authManager:i,portalHost:s.PORTAL_HOST};try{const e=(0,d.N)(u),p=await c.ZP.fetchItemDetails(g);if(!(0,a.mT)(p,u)){const e=(0,a.HL)(p);throw new r.Z({type:"item-not-supported-on-route",itemType:e})}if(p.origin)return m&&(0,v.j)({ctx:o,href:`/${e}/${t}`,asPath:`${s.BASE_URL}/${e}/${t}`}),{success:!1,redirect:{asPath:`${s.BASE_URL}/${e}/${t}`}};if("update"===p.itemControl||"admin"===p.itemControl){if((0,y.ZX)(p)||(0,f.bk)(p))return m&&(0,v.j)({ctx:o,href:`/${e}/edit?id=${t}`,asPath:`${s.BASE_URL}/${e}/${t}/edit`}),{success:!1,redirect:{asPath:`${s.BASE_URL}/${e}/${t}/edit`}};if("undefined"!==typeof o){const{res:e}=o;e&&"function"===typeof e.setHeader&&e.setHeader("Cache-Control","max-age=0, private, must-revalidate")}const{itemData:a}=await c.ZP.fetchItemDraftData({itemDetails:p,type:u,authManager:i,portalHost:s.PORTAL_HOST,config:s}),r=a,d=await(0,l.ir)({storyItemData:r,authManager:i,portalHost:s.PORTAL_HOST});return{success:!0,id:t,itemDetails:p,draftData:r,initialThemeItemInfo:d,pageLocale:(0,n.kz)(r)}}throw new r.Z({type:"story-privileges-preview",itemType:u})}catch(x){if("string"===typeof x.message&&"item-not-supported-on-route"===x.message&&t){const a=e.convertRoute({routeDef:{route:"preview",itemType:x.itemType,itemId:t},featureDecisions:{canAccessExternalUrls:!1},config:s,authManager:i}),r="error?errType=item-not-supported-on-route`",n=`${s.BASE_URL}/${r}`;return m&&(0,v.j)({ctx:o,href:a.href.pathname||a.href||r,asPath:a.as||n}),{redirect:{asPath:a.as||n},success:!1}}if(x instanceof r.Z)throw new r.Z(x);return(0,w.q)({ctx:o,authManager:i,signInUrl:h,error:x,config:s}),{redirect:{asPath:""},error:x,success:!1}}},k=e=>{let{config:t,formatMessage:i}=e;return{success:!0,...(0,p.kS)({formatMessage:i,baseUrl:t.BASE_URL,siteUrl:(0,x.o)({siteUrl:t.SITE_URL,isComponentMounted:!0}),productName:t.PRODUCT_NAME,baseThemeId:(0,h.TI)(t.INCLUDED_STORY_THEMES)}),initialThemeItemInfo:{}}},P=(e,t)=>{const i=13462453245;return{id:t||"",itemDetails:{...(0,u.rV)(s.o.Frame,e),created:i,modified:i,owner:"ton12618@esri.com",numViews:1e4,id:t||"",size:2},publishedData:(0,u.Fn)(),host:"",initialThemeItemInfo:{},success:!0}}},29179:function(e,t,i){i.d(t,{q:function(){return d}});var s=i(63789),o=i(36871),a=i(79562),r=i(69466);class n extends Error{constructor(e){super(),this.name="WebsiteError",this.type=this.message=e;const{statusCode:t}=(0,r.P)(this.type);this.statusCode=t}}var l=i(69318);const d=e=>{var t,i,r;const{authManager:d,error:p,signInUrl:c,config:h,ctx:u}=e,m=e=>{(0,l.j)({ctx:u,asPath:`${h.BASE_URL}${e}`,href:e})};if(!p||!p.code)return void m("/error?errType=story-load");let g;const f=null===(t=e.ctx)||void 0===t?void 0:t.pathname;switch(g=(null===(i=f)||void 0===i?void 0:i.includes("/collections/"))?s.o.Collection:(null===(r=f)||void 0===r?void 0:r.includes("/themes/"))?s.o.Theme:s.o.Story,p.code){case a._n.ITEM_ACCESS_UNAUTHORIZED:if(d&&d.token)throw new o.Z({type:"story-inaccessible",itemType:g});(0,l.j)({ctx:u,href:c,isExternal:!0});break;case a._n.OWNER_SUBSCRIPTION_DISABLED:m("/error?errType=story-inaccessible");break;case a._n.ITEM_NONEXISTENT_OR_INACCESSIBLE:throw new o.Z({type:"story-not-found",itemType:g});case a._n.APP_BLOCKED_FOR_ORG:throw new n("blocked-org");default:{var y,x,v;const e=null===(v=p)||void 0===v||null===(x=v.response)||void 0===x||null===(y=x.error)||void 0===y?void 0:y.code;throw 403===e?new o.Z({type:"story-inaccessible",itemType:g}):400===e||404===e?new o.Z({type:"story-not-found",itemType:g}):new o.Z({type:"story-load",itemType:g})}}}}}]);