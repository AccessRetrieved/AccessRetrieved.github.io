"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2660,7152,73987],{99711:function(e,t,i){i.d(t,{Z:function(){return me}});var s=i(19353),r=i(69788),l=i(96977),o=i(71633),n=i(19928),a=i(60346),c=i(970),u=i(41230),d=i(68205),h=i(44817),p=i(27985),v=i(33788),f=i(51282),m=i(85785),y=i(72964),g=i(72035),w=i(44569),b=(i(72325),i(70588)),_=i(3968),I=i(30357),M=i(33988),L=i(64415),F=i(23855),S=i(95889),C=i(58448),A=i(13681),O=i(35783),N=i(26974),T=i(86395),x=i(99731),R=i(77014),B=i(70276),k=i(5193);function E(){return new a.Z("webscene:failed-to-copy-embedded-resources","Copying of embedded resources is currently not supported")}function P(e){return new a.Z("webscene:schema-validation","Failed to save webscene due to schema validation errors. See 'details.errors' for more detailed information",{errors:e})}var Z,V=i(66445),$=i(46197),W=i(73987),U=i(58169),j=i(90791),z=(i(24431),i(79285),i(35567));let G=Z=class extends j.wq{constructor(e){super(e),this.viewing=null}clone(){return new Z({viewing:this.viewing?this.viewing.clone():null})}};(0,s._)([(0,w.Cb)({type:z.Z,json:{write:!0}})],G.prototype,"viewing",void 0),G=Z=(0,s._)([(0,_.j)("esri.webscene.ApplicationProperties")],G);const q=G;var D,H=i(58442);let J=D=class extends j.wq{constructor(e){super(e),this.environment=new H.Z,this.spatialReference=null,this.viewpoint=null}set viewingMode(e){this._set("viewingMode",e)}clone(){return new D({environment:this.environment.clone(),spatialReference:this.spatialReference?this.spatialReference.clone():null,viewingMode:this.viewingMode,viewpoint:this.viewpoint?this.viewpoint.clone():null})}};(0,s._)([(0,w.Cb)({type:H.Z,json:{write:{isRequired:!0}}})],J.prototype,"environment",void 0),(0,s._)([(0,w.Cb)({type:A.Z})],J.prototype,"spatialReference",void 0),(0,s._)([(0,w.Cb)({type:["local","global"]})],J.prototype,"viewingMode",null),(0,s._)([(0,w.Cb)({type:o.Z,json:{write:{isRequired:!0}}})],J.prototype,"viewpoint",void 0),J=D=(0,s._)([(0,_.j)("esri.webscene.InitialViewProperties")],J);const K=J;var Y=i(68600),X=i(78507),Q=i(38719);const ee=n.Z.ofType(Q.Z);let te=class extends j.wq{constructor(e){super(e),this.slides=new ee}destroy(){this.slides.forEach((e=>e.destroy())),this.slides.removeAll()}set slides(e){e&&(e=e.filter((e=>!!e.viewpoint))),this._set("slides",(0,Y.Z)(e,this._get("slides"),ee))}clone(){return new(0,this.constructor)({slides:this.slides.clone()})}};(0,s._)([(0,w.Cb)({type:ee,nonNullable:!0,json:{write:!0}}),(0,X.p)(Y.R)],te.prototype,"slides",null),te=(0,s._)([(0,_.j)("esri.webscene.Presentation")],te);const ie=te;var se;let re=se=class extends j.wq{constructor(e){super(e)}clone(){return new se({name:this.name,path:this.path,title:this.title})}};(0,s._)([(0,w.Cb)({type:String,json:{write:!0}})],re.prototype,"name",void 0),(0,s._)([(0,w.Cb)({type:String,json:{write:!0}})],re.prototype,"path",void 0),(0,s._)([(0,w.Cb)({type:String,json:{write:!0}})],re.prototype,"title",void 0),re=se=(0,s._)([(0,_.j)("esri.webscene.TransportationNetwork")],re);const le=re;var oe=i(9986);class ne extends oe.G{constructor(e,t){super(e,t,"webscene")}get supportsGround(){return this.since(1,8)}get supportsVisibleElevationLayersInSlides(){return this.lessThan(1,8)}}let ae=null;var ce;const ue=new ne(1,31),de="Web Scene",he="ViewingMode-Local";let pe=class extends(u.Z.LoadableMixin((0,f.v)((0,v.R)(l.Z)))){constructor(e){super(e),this[ce]=!0,this._layersIdGCTimeoutId=void 0,this._updateFromPromise=null,this.applicationProperties=null,this.clippingArea=null,this.clippingEnabled=!1,this.floorInfo=null,this.heightModelInfo=void 0,this.sourceVersion=null,this.transportationNetworks=null,this.presentation=new ie,this.initialViewProperties=new K,this.portalItem=null,this.resourceInfo=null,this._debouncedSaveOperations=(0,m.Ds)((async(e,t,i)=>{switch(e){case ve.SAVE:return this._saveImpl(t);case ve.SAVE_AS:return this._saveAsImpl(i,t)}})),this._resourceReferences={portalItem:null,paths:[]},this.authoringApp=null,this.authoringAppVersion=null,this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1}initialize(){if(this.when().catch((e=>{h.Z.getLogger(this).error("#load()","Failed to load web scene",e)})),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(fe){return void this.addResolvingPromise(Promise.reject(fe))}this.read(e),this.addResolvingPromise(this._validateSpatialReference()),this.addResolvingPromise(this._validateHeightModelInfo())}this.addHandles([(0,y.on)((()=>this.tables),"before-add",(e=>{e.preventDefault(),h.Z.getLogger(this).errorOnce("tables","Tables are not yet supported in a WebScene")})),(0,y.on)((()=>this.allLayers),"change",(()=>this._scheduleLayersIdGC()))])}destroy(){this._unscheduleLayersIdGC(),this.presentation&&this.presentation.destroy(),this.portalItem=(0,p.SC)(this.portalItem),this.basemap?.destroy()}writeClippingArea(e,t){t.clippingArea||(t.clippingArea={}),t.clippingArea.geometry=e.toJSON()}readClippingEnabled(e,t){return!!t.clippingArea&&!!t.clippingArea.clip}writeClippingEnabled(e,t){this.clippingArea&&(t.clippingArea||(t.clippingArea={}),t.clippingArea.clip=e)}writeLayers(e,t,i,s){const r={...s,layerContainerType:"operational-layers"},l=e.map((e=>this.verifyWriteLayer(e,s)?e.write({},r):null)).filter((e=>!!e));t[i]=l.toArray()}verifyWriteLayer(e,t){return"write"in e||(t&&t.messages&&t.messages.push(new a.Z("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted in web scenes`,{layer:e})),!1)}readSourceVersion(e,t){const[i,s]=t.version.split(".");return new ne(parseInt(i,10),parseInt(s,10))}writeSourceVersion(e,t,i){t[i]=`${ue.major}.${ue.minor}`}get thumbnailUrl(){return this.portalItem?.thumbnailUrl??null}set thumbnailUrl(e){e?this._override("thumbnailUrl",e):(this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp="ArcGIS API for JavaScript"}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=r.i8}writeGround(e,t,i,s){t[i]=e?e.write({},s):{transparency:0,layers:[]}}readInitialViewProperties(e,t){const i={};return t.initialState&&t.initialState.environment&&(i.environment=H.Z.fromJSON(t.initialState.environment)),t.spatialReference?i.spatialReference=A.Z.fromJSON(t.spatialReference):i.spatialReference=A.Z.WebMercator,i.viewingMode=t.viewingMode||"global",t.initialState&&t.initialState.viewpoint&&(i.viewpoint=o.Z.fromJSON(t.initialState.viewpoint)),new K(i)}get spatialReference(){return this.initialViewProperties?.spatialReference??A.Z.WebMercator}get viewingMode(){return this.initialViewProperties?.viewingMode??"global"}load(e){const t=this.ground;return this.addResolvingPromise(this._loadFromSource().then((()=>{t&&t!==this.ground&&t.destroy()}))),Promise.resolve(this)}loadAll(){return(0,d.G)(this,(e=>{const t=this.presentation&&this.presentation.slides;e(this.ground,this.basemap,this.layers,t&&t.map((e=>e.basemap)))}))}read(e,t){t={...t,origin:"web-scene"};const i=this._isAuthoringAppVersionSetByUser,s=this._isAuthoringAppSetByUser;if((0,L.$)(this,e,(t=>super.read(e,t)),t),s||(this._isAuthoringAppSetByUser=!1),i||(this._isAuthoringAppVersionSetByUser=!1),e.baseMap&&Array.isArray(e.baseMap.elevationLayers)&&this.sourceVersion?.supportsVisibleElevationLayersInSlides){const t=e.baseMap.elevationLayers.map((e=>({id:e.id}))),i=this.presentation.slides,s=(e,t)=>e.visibleLayers.some((e=>e.id===t)),r=t.filter((e=>!i.some((t=>s(t,e.id)))));i.forEach((e=>{e.visibleLayers.addMany(r)}))}}_writeBasemapElevationLayers(e){const t=e.ground&&e.ground.layers;!e.baseMap&&t&&t.length&&(e.baseMap={title:"Basemap",baseMapLayers:[]}),e.baseMap&&(e.baseMap.elevationLayers=(0,c.d9)(t))}write(e,t){if("loaded"!==this.loadStatus){const e=new a.Z("webscene:not-loaded","Web scene must be loaded before it can be serialized");throw h.Z.getLogger(this).error("#toJSON()","Web scene must be loaded before it can be serialized",this.loadError||this.loadStatus),e}this._runLayersIdGC();const i=!t?.messages;t={messages:[],...t,origin:"web-scene"};const s=super.write(e,t);if(i){const e=t.messages?.filter((e=>"web-document-write:property-required"===e.name))??[];if(e.length){const t=new a.Z("web-document:property-required","One or more properties that are required in the webscene JSON are missing, see details for the specific errors",{errors:e});throw h.Z.getLogger(this).error("#toJSON()","One or more properties that are required in the webscene JSON are missing",e),t}}return this._writeBasemapElevationLayers(s),s}async save(e){return this._debouncedSaveOperations(ve.SAVE,e)}async _saveImpl(e){if(!this.portalItem)throw h.Z.getLogger(this).error("save(): requires the .portalItem property to be set"),await Promise.resolve(),new a.Z("webscene:portal-item-not-set","Portal item to save to has not been set on the WebScene");if(this.portalItem?.type!==de)throw await Promise.resolve(),new a.Z("webscene:portal-item-wrong-type",`Portal item needs to have type "${de}"`);const t=this._updateFromPromise;await this._ensureLoadBeforeSave();const i=this._enableVerifyItemRelativeUrls({origin:"web-scene",url:this.portalItem.itemUrl?(0,g.mN)(this.portalItem.itemUrl):null,messages:[],portal:this.portalItem.portal??x.Z.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),s=this.write({},i);return await Promise.all(i.resources.pendingOperations),await this._verifySave(s,i,e),this._updateTypeKeywords(this.portalItem),await this.portalItem.update({data:s}),await(0,W.saveResources)(this._resourceReferences,i,null),(0,M.D)(i),t&&await t,await this._saveThumbnail(),this.portalItem}async saveAs(e,t){return this._debouncedSaveOperations(ve.SAVE_AS,t,e)}async _saveAsImpl(e,t){let i=R.default.from(e);i||(h.Z.getLogger(this).error("saveAs(portalItem): requires a portal item parameter"),await Promise.reject(new a.Z("webscene:portal-item-required","saveAs requires a portal item to save to"))),i.id&&(i=i.clone(),i.id=null);const s=i.portal||x.Z.getDefault();await this._ensureLoadBeforeSave(),i.type=de,i.portal=s;const r=this._enableVerifyItemRelativeUrls({origin:"web-scene",url:null,messages:[],portal:s,portalItem:i,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),l=this.write({},r);await Promise.all(r.resources.pendingOperations),await this._verifySaveAs(l,r,t);const o=this.thumbnailUrl,n=!this._isOverridden("thumbnailUrl");return this._updateTypeKeywords(i),await s.signIn(),await(s.user?.addItem({item:i,folder:t&&t.folder,data:l})),await(0,W.saveResources)(this._resourceReferences,r,null),this.portalItem=i,v.w.prototype.read.call(this,{version:l.version,authoringApp:l.authoringApp,authoringAppVersion:l.authoringAppVersion},{name:"web-scene",ignoreDefaults:!0,url:i.itemUrl?(0,g.mN)(i.itemUrl):void 0}),(0,M.D)(r),o&&(this.thumbnailUrl=n?(0,g.ZN)(o,"w","8192"):o),r.portalItem=i,await this._saveThumbnail(),i}async _saveThumbnail(){this._isOverridden("thumbnailUrl")&&(await(this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl})),this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}_verifySave(e,t,i,s=!1){if(!(0,T.N$)(this.spatialReference))return Promise.reject(new a.Z("webscene:unsupported-spatial-reference","Webscenes using spatial reference systems from Mars or Moon can not be saved currently."));let r,l=t.messages?.filter((e=>"error"===e.type)).map((e=>new a.Z(e.name,e.message,e.details)))??[];t.blockedRelativeUrls&&(l=l.concat(t.blockedRelativeUrls.map((e=>new a.Z("url:unsupported",`Relative url '${e}' is not supported in Web Scene`))))),i&&i.ignoreUnsupported&&(l=l.filter((e=>"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name&&"scenemodification:unsupported"!==e.name))),i?.requiredPropertyChecksDisabled&&(l=l.filter((e=>"web-document-write:property-required"!==e.name)));return r=!!i?.strictSchemaValidationEnabled&&ae?ae().then((t=>{const i=t.validate(e);if(i.length>0){const e=`webscene did not validate:\n${i.join("\n")}`;h.Z.getLogger(this).error(`${s?"saveAs":"save"}(): ${e}`)}return i.map((e=>new a.Z("webscene:schema-validation",e)))})).then((e=>{if(e.length>0)throw P(e.concat(l));return l})):Promise.resolve(l),r.then((e=>{if(e.length>0)throw new a.Z("webscene:save","Failed to save webscene due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:e})}))}_verifySaveAs(e,t,i){return this.canNotSaveAs(t)?Promise.reject(E()):this._verifySave(e,t,i,!0)}verifySaveAs(e){const t=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),i=this.write({},t);return this._verifySaveAs(i,t,e)}canNotSaveAs(e){return e||(e=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),this.write({},e)),(e.verifyItemRelativeUrls?.writtenUrls?.length??0)>0}async updateFrom(e,t={}){const i=this._updateFrom(e,t);this._updateFromPromise=i,await i,this._updateFromPromise===i&&(this._updateFromPromise=null)}async _updateFrom(e,t={}){if(await e.whenReady(),!t.environmentExcluded&&e.environment&&(this.initialViewProperties.environment=H.Z.prototype.clone.apply(e.environment)),!t.viewpointExcluded&&e.viewpoint&&(this.initialViewProperties.viewpoint=e.viewpoint.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),this.initialViewProperties.viewingMode=e.viewingMode,null!=e.clippingArea?e.clippingArea!==this.clippingArea&&(this.clippingArea=e.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1,e.heightModelInfo&&(this.heightModelInfo=e.heightModelInfo.clone()),e.map===this)for(const i of e.allLayerViews){const e="visible";e in i&&e in i.layer&&i._isOverridden(e)&&(i.layer[e]=i[e])}(!1===t.thumbnailExcluded||null==t.thumbnailExcluded&&!t.viewpointExcluded)&&await this._updateFromThumbnail(e,t.thumbnailSize??void 0)}async _updateFromThumbnail(e,t){const i=(0,U.w)(e,t),s=await e.takeScreenshot({format:"jpg",width:i.width,height:i.height,disableDecorations:!0});this.thumbnailUrl=s.dataUrl}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-scene"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):this._loadObjectsWithLayers()}_readAndLoadFromJSON(e,t){const i=this._validateJSON(e);return this.read(i,t),this._loadFromJSON(i,t)}_extractOperationalLayers(e){const t=[];if(!this.sourceVersion?.supportsGround&&e.baseMap&&Array.isArray(e.baseMap.elevationLayers))for(const r of e.baseMap.elevationLayers)t.push(r);const i=[],s=e=>(e.layers&&(e.layers=e.layers.filter(s)),"ArcGISTiledElevationServiceLayer"!==e.layerType||(this.sourceVersion?.supportsGround||i.push(e),!1));return{operationalLayers:e.operationalLayers?e.operationalLayers.filter(s):[],operationalElevationLayers:i,basemapElevationLayers:t}}_loadFromJSON(e,t){const s=new n.Z;return this._validateSpatialReference().then((()=>this._validateHeightModelInfo())).then((()=>i.e(39602).then(i.bind(i,38564)))).then((({populateOperationalLayers:i})=>{const{operationalLayers:r,operationalElevationLayers:l,basemapElevationLayers:o}=this._extractOperationalLayers(e),n=[],a={context:{...t,layerContainerType:"operational-layers"}};if(this.portalItem&&(a.context.portal=this.portalItem.portal||x.Z.getDefault()),o.length>0){const e={...a,context:{...a.context,layerContainerType:"ground"}};e.defaultLayerType="ArcGISTiledElevationServiceLayer",n.push(i(this.ground.layers,o,e))}if(l.length>0){const e={...a,context:{...a.context,layerContainerType:"ground"}};e.defaultLayerType="ArcGISTiledElevationServiceLayer",n.push(i(s,l,e))}return r&&r.length>0&&n.push(i(this.layers,r,a)),(0,m.as)(n).then((()=>{}))})).then((()=>this._loadObjectsWithLayers())).then((()=>{this.ground.layers.addMany(s)}))}async _ensureLoadBeforeSave(){await this.load(),await this._loadObjectsWithLayers();const e=[],t=[...this.allLayers.items];for(const{basemap:i}of this.presentation.slides.items)i&&(t.push(...i.baseLayers.items),t.push(...i.referenceLayers.items));for(const i of t)if("beforeSave"in i&&"function"==typeof i.beforeSave){const t=i.beforeSave();t&&e.push(t)}await(0,m.as)(e)}async _loadObjectsWithLayers(){const e=[];this.ground&&e.push(this.ground.load()),this.basemap&&e.push(this.basemap.load()),this.presentation.slides.forEach((t=>{t.basemap&&e.push(t.basemap.load())})),await(0,m.as)(e)}async _loadFromItem(e){if(await e.load().catch((e=>{throw new a.Z("webscene:load-portal-item","Failed to load portal item",{error:e})})),"Web Scene"!==e.type)throw new a.Z("webscene:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Scene'",{type:e.type});const t=await e.fetchData();this.resourceInfo=t;const i={origin:"web-scene",url:(0,g.mN)(e.itemUrl),portal:e.portal||x.Z.getDefault(),portalItem:e,readResourcePaths:[]};await this._readAndLoadFromJSON(t,i),this._resourceReferences={portalItem:e,paths:i.readResourcePaths??[]}}_validateSpatialReference(){const e=this.initialViewProperties,t=this._sceneSpatialReference;let i;if("local"!==e.viewingMode){if(!(0,$.D)(t,V.JY.Global))return Promise.reject(new a.Z("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported",{spatialReference:t,viewingMode:e.viewingMode}));i=e=>!e||(0,C.Up)(e,t)}else{if(!(0,$.D)(t,V.JY.Local))return Promise.reject(new a.Z("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported",{spatialReference:t,viewingMode:e.viewingMode}));i=e=>!e||e.equals(t)}const s=e=>e?.camera?.position.spatialReference??e?.targetGeometry?.spatialReference,r=e.viewpoint,l=s(r);if(l&&!i(l))return Promise.reject(new a.Z("webscene:incompatible-camera-spatial-reference","Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{cameraSpatialReference:l,sceneSpatialReference:t,viewingMode:e.viewingMode}));const o=this.presentation.slides.find((e=>!i(s(e.viewpoint))));if(o){const i=s(o.viewpoint);return Promise.reject(new a.Z("webscene:incompatible-slide-spatial-reference","Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{slideSpatialReference:i,sceneSpatialReference:t,viewingMode:e.viewingMode}))}return Promise.resolve()}_validateHeightModelInfo(){const e=this._sceneSpatialReference,t=(0,O.vu)(this.heightModelInfo,e);return t?Promise.reject(t):Promise.resolve()}_validateJSON(e){const t=ne.parse(e.version||"","webscene");return ue.validate(t),e.version=`${t.major}.${t.minor}`,1===t.major&&t.minor<=2&&(e.spatialReference=A.Z.WebMercator.toJSON()),e}_updateTypeKeywords(e){"local"===this.initialViewProperties.viewingMode?e.typeKeywords?e.typeKeywords.includes(he)||e.typeKeywords.push(he):e.typeKeywords=[he]:"global"===this.initialViewProperties.viewingMode&&e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((e=>e!==he))),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,i)=>i.indexOf(e)===t)))}get _sceneSpatialReference(){return this.initialViewProperties.spatialReference||A.Z.WebMercator}get _verifyItemRelativeRootPath(){return this.portalItem?.itemUrl?(0,g.mN)(this.portalItem.itemUrl).path:null}_enableVerifyItemRelativeUrls(e){const t=this._verifyItemRelativeRootPath;return t&&(e.verifyItemRelativeUrls={rootPath:t,writtenUrls:[]}),e}_unscheduleLayersIdGC(){this._layersIdGCTimeoutId&&(clearTimeout(this._layersIdGCTimeoutId),this._layersIdGCTimeoutId=0)}_scheduleLayersIdGC(){this._unscheduleLayersIdGC(),this._layersIdGCTimeoutId=setTimeout((()=>{this._layersIdGCTimeoutId=0,this._runLayersIdGC()}),3e3)}_runLayersIdGC(){this._unscheduleLayersIdGC();const e=this.applicationProperties&&this.applicationProperties.viewing&&this.applicationProperties.viewing.search,t=e=>this.allLayers.some((t=>t.id===e));e&&e.layers&&(e.layers=e.layers.filter((e=>t(e.id))));const i=this.presentation&&this.presentation.slides;i&&i.forEach((e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((e=>t(e.id))))}))}static fromJSON(e){if(!e)throw new a.Z("webscene:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}};var ve,fe;ce=k.x,pe.version=`${ue.major}.${ue.minor}`,(0,s._)([(0,w.Cb)({type:q,json:{write:!0}})],pe.prototype,"applicationProperties",void 0),(0,s._)([(0,w.Cb)({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],pe.prototype,"basemap",void 0),(0,s._)([(0,w.Cb)({type:F.Z,json:{read:{source:"clippingArea.geometry",reader:N.im},write:{target:"clippingArea.geometry"}}})],pe.prototype,"clippingArea",void 0),(0,s._)([(0,I.c)("clippingArea")],pe.prototype,"writeClippingArea",null),(0,s._)([(0,w.Cb)({type:Boolean,json:{write:{target:"clippingArea.clip"}}})],pe.prototype,"clippingEnabled",void 0),(0,s._)([(0,b.r)("clippingEnabled",["clippingArea"])],pe.prototype,"readClippingEnabled",null),(0,s._)([(0,I.c)("clippingEnabled")],pe.prototype,"writeClippingEnabled",null),(0,s._)([(0,w.Cb)({type:B.Z,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],pe.prototype,"floorInfo",void 0),(0,s._)([(0,w.Cb)({type:S.Z,json:{write:!0}})],pe.prototype,"heightModelInfo",void 0),(0,s._)([(0,w.Cb)({json:{write:{target:"operationalLayers",ignoreOrigin:!0}}})],pe.prototype,"layers",void 0),(0,s._)([(0,I.c)("layers")],pe.prototype,"writeLayers",null),(0,s._)([(0,w.Cb)({readOnly:!0,type:ne,json:{type:(()=>{const e=[],t=ue.major;for(let i=8;i<=ue.minor;i++)e.push(`${t}.${i}`);return e})(),write:{ignoreOrigin:!0,target:"version",isRequired:!0,overridePolicy:()=>({enabled:!0,allowNull:!0,ignoreOrigin:!0})}}})],pe.prototype,"sourceVersion",void 0),(0,s._)([(0,b.r)("sourceVersion",["version"])],pe.prototype,"readSourceVersion",null),(0,s._)([(0,I.c)("sourceVersion")],pe.prototype,"writeSourceVersion",null),(0,s._)([(0,w.Cb)({json:{read:!1,write:!1}})],pe.prototype,"tables",void 0),(0,s._)([(0,w.Cb)()],pe.prototype,"thumbnailUrl",null),(0,s._)([(0,w.Cb)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],pe.prototype,"authoringApp",null),(0,s._)([(0,I.c)("authoringApp")],pe.prototype,"writeAuthoringApp",null),(0,s._)([(0,w.Cb)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],pe.prototype,"authoringAppVersion",null),(0,s._)([(0,I.c)("authoringAppVersion")],pe.prototype,"writeAuthoringAppVersion",null),(0,s._)([(0,w.Cb)({json:{write:{isRequired:!0,allowNull:!0,ignoreOrigin:!0,enabled:!0}}})],pe.prototype,"ground",void 0),(0,s._)([(0,I.c)("ground")],pe.prototype,"writeGround",null),(0,s._)([(0,w.Cb)({type:n.Z.ofType(le),json:{write:!0}})],pe.prototype,"transportationNetworks",void 0),(0,s._)([(0,w.Cb)({type:ie,nonNullable:!0,json:{write:{ignoreOrigin:!0,writer:(e,t,i,s)=>{if(e.slides&&e.slides.length>0){const i={...s,isPresentation:!0};t.presentation=e.write({},i)}}}}})],pe.prototype,"presentation",void 0),(0,s._)([(0,w.Cb)({type:K,nonNullable:!0,json:{write:{target:"initialState",isRequired:!0,ignoreOrigin:!0},default:()=>new K({viewingMode:"global",spatialReference:A.Z.WebMercator})}})],pe.prototype,"initialViewProperties",void 0),(0,s._)([(0,b.r)("initialViewProperties",["initialState.environment","spatialReference","viewingMode","initialState.viewpoint"])],pe.prototype,"readInitialViewProperties",null),(0,s._)([(0,w.Cb)({type:A.Z,json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],pe.prototype,"spatialReference",null),(0,s._)([(0,w.Cb)({type:["local","global"],json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],pe.prototype,"viewingMode",null),(0,s._)([(0,w.Cb)({type:R.default})],pe.prototype,"portalItem",void 0),(0,s._)([(0,w.Cb)()],pe.prototype,"resourceInfo",void 0),pe=(0,s._)([(0,_.j)("esri.WebScene")],pe),(fe=ve||(ve={}))[fe.SAVE=0]="SAVE",fe[fe.SAVE_AS=1]="SAVE_AS";const me=pe},7152:function(e,t,i){i.d(t,{W7:function(){return h},addOrUpdateResource:function(){return n},fetchResources:function(){return o},removeAllResources:function(){return c},removeResource:function(){return a}});var s=i(54380),r=i(60346),l=i(72035);async function o(e,t={},i){await e.load(i);const s=(0,l.v_)(e.itemUrl,"resources"),{start:r=1,num:o=10,sortOrder:n="asc",sortField:a="created"}=t,c={query:{start:r,num:o,sortOrder:n,sortField:a,token:e.apiKey},signal:i?.signal},u=await e.portal.request(s,c);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map((({created:t,size:i,resource:s})=>({created:new Date(t),size:i,resource:e.resourceFromPath(s)})))}}async function n(e,t,i,o){if(!e.hasPath())throw new r.Z(`portal-item-resource-${t}:invalid-path`,"Resource does not have a valid path");const n=e.portalItem;await n.load(o);const a=(0,l.v_)(n.userItemUrl,"add"===t?"addResources":"updateResources"),[c,d]=u(e.path),h=await async function(e){return e instanceof Blob?e:(await(0,s.default)(e.url,{responseType:"blob"})).data}(i),p=new FormData;return c&&"."!==c&&p.append("resourcesPrefix",c),null!=o&&o.compress&&p.append("compress","true"),p.append("fileName",d),p.append("file",h,d),p.append("f","json"),null!=o&&o.access&&p.append("access",o.access),await n.portal.request(a,{method:"post",body:p,signal:o?.signal}),e}async function a(e,t,i){if(!t.hasPath())throw new r.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(i);const s=(0,l.v_)(e.userItemUrl,"removeResources");await e.portal.request(s,{method:"post",query:{resource:t.path},signal:i?.signal}),t.portalItem=null}async function c(e,t){await e.load(t);const i=(0,l.v_)(e.userItemUrl,"removeResources");return e.portal.request(i,{method:"post",query:{deleteAll:!0},signal:t?.signal})}function u(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function d(e){const[t,i]=function(e){const t=(0,l.Ml)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[s,r]=u(t);return[s,r,i]}function h(e,t){if(!e.hasPath())return null;const[i,,s]=d(e.path);return e.portalItem.resourceFromPath((0,l.v_)(i,t+s))}},5193:function(e,t,i){i.d(t,{x:function(){return s}});const s=Symbol("WebScene")},73987:function(e,t,i){i.r(t),i.d(t,{saveResources:function(){return a}});var s=i(40336),r=i(60346),l=i(85785),o=i(3900),n=i(7152);async function a(e,t,i){if(!t||!t.resources)return;const s=t.portalItem===e.portalItem?new Set(e.paths):new Set;e.paths.length=0,e.portalItem=t.portalItem;const a=new Set(t.resources.toKeep.map((e=>e.resource.path))),d=new Set,h=[];a.forEach((t=>{s.delete(t),e.paths.push(t)}));for(const r of t.resources.toUpdate)if(s.delete(r.resource.path),a.has(r.resource.path)||d.has(r.resource.path)){const{resource:t,content:s,finish:l,error:a}=r,u=(0,n.W7)(t,(0,o.D)());e.paths.push(u.path),h.push(c({resource:u,content:s,compress:r.compress,finish:l,error:a},i))}else e.paths.push(r.resource.path),h.push(u(r,i)),d.add(r.resource.path);for(const r of t.resources.toAdd)h.push(c(r,i)),e.paths.push(r.resource.path);if(s.forEach((e=>{if(t.portalItem){const i=t.portalItem.resourceFromPath(e);h.push(i.portalItem.removeResource(i).catch((()=>{})))}})),0===h.length)return;const p=await(0,l.as)(h);(0,l.k_)(i);const v=p.filter((e=>"error"in e)).map((e=>e.error));if(v.length>0)throw new r.Z("save:resources","Failed to save one or more resources",{errors:v})}async function c(e,t){const i={...null!=t?t:{},compress:e.compress},r=await(0,s.q6)(e.resource.portalItem.addResource(e.resource,e.content,i));if(!0!==r.ok)throw e.error?.(r.error),r.error;e.finish?.(e.resource)}async function u(e,t){const i=await(0,s.q6)(e.resource.update(e.content,t));if(!0!==i.ok)throw e.error?.(i.error),i.error;e.finish?.(e.resource)}},1988:function(e,t,i){i.d(t,{Z:function(){return T}});var s=i(19353),r=(i(4516),i(76309)),l=i(72964),o=i(44569),n=(i(72325),i(24431),i(79285),i(3968)),a=i(36317);const c="esri-floor-filter",u=`${c}__filter-menu`,d={esriWidget:"esri-widget",esriWidgetButton:"esri-widget--button",esriWidgetButtonActive:"esri-widget--button-active",esriButtonDisabled:"esri-button--disabled",esriDisabled:"esri-disabled",esriIcon:"esri-icon",esriInteractive:"esri-interactive",esriWidgetContentEmpty:"esri-widget__content--empty",floorFilter:c,floorFilterLayout:`${c}__layout--`,floorFilterPosition:`${c}__position--`,buttonContainer:`${c}__button-container`,buttonContainerLevels:`${c}__button-container--levels`,buttonInfo:`${c}__button-info`,buttonLabel:`${c}__button-label`,browseButton:`${c}__browse-button`,closeLevelsButton:`${c}__close-levels-button`,zoomButton:`${c}__zoom-button`,zoomButtonLevels:`${c}__zoom-button--levels`,minimizeToggleButton:`${c}__minimize-toggle-button`,levelsContainer:`${c}__levels-container`,levelButton:`${c}__level-button`,levelButtonActive:`${c}__level-button--active`,separator:`${c}__separator`,filterMenu:u,filterMenuHeader:`${u}-header`,filterMenuHeaderTextGroup:`${u}-header-text-group`,filterMenuHeaderText:`${u}-header-text`,filterMenuHeaderSubtext:`${u}-header-subtext`,filterMenuHeaderBack:`${u}-header-back`,filterMenuSearch:`${u}-search`,filterMenuSearchInput:`${u}-search-input`,filterMenuItems:`${u}-items`,filterMenuItemName:`${u}-item-name`,filterMenuSelectedItem:`${u}-item-name--selected`,filterMenuSite:`${u}-site`,filterMenuFacility:`${u}-facility`,selectedItemCircle:`${c}__selected-item-circle`,urbanIcon:"esri-icon-urban-model",zoomToIcon:"esri-icon-zoom-to-object",collapseIconRight:"esri-icon-collapse",collapseIconLeft:"esri-icon-expand",expandIconRight:"esri-icon-expand",expandIconLeft:"esri-icon-collapse",closeIcon:"esri-icon-close",searchIcon:"esri-icon-search",rightIcon:"esri-icon-right",leftIcon:"esri-icon-left"};var h=i(40336),p=i(19928),v=i(60346),f=i(84176),m=i(85785),y=i(91885),g=i(23873),w=i(97597),b=i(81334);function _(e){return"esri.WebMap"===e.declaredClass}let I=class extends((0,b._)(f.r)){constructor(e){super(e),this.filterMenuOpen=!1,this.filterMenuType="site",this.filterMode="base-floors",this.levelsExpanded=!0,this.searchTerm=null,this.view=null,this._updateFloorFilterTask=null,this._viewHeightBreakpoint=null,this._viewWidthBreakpoint=null}initialize(){this.addHandles([(0,l.YP)((()=>this.view?.map),(e=>{null!=this._updateFloorFilterTask&&(this._updateFloorFilterTask.abort(),this._updateFloorFilterTask=null),this._updateFloorFilterTask=(0,h.vr)((async t=>{await this._updateFloorFilterFromMap(e),(0,m.k_)(t),this._setInitialViewState(e)}))}),l.nn),(0,l.YP)((()=>this.view),((e,t)=>{this._unregisterWidget(t),this._registerWidget(e),this._watchSearchResults(e)}),l.tX),(0,l.YP)((()=>this.view?.widthBreakpoint??null),(e=>{this._viewWidthBreakpoint=e})),(0,l.YP)((()=>this.view?.heightBreakpoint??null),(e=>{this._viewHeightBreakpoint=e}))])}destroy(){this._unregisterWidget(this.view),this.view=null,null!=this._updateFloorFilterTask&&(this._updateFloorFilterTask.abort(),this._updateFloorFilterTask=null)}set enabled(e){this._callOverride("enabled",e)}set facility(e){if(e&&this._isOverridden("facility")){const t=this.getFacility(e);this.hasMultipleSites&&(this.site=t?.siteId||null)}this._callOverride("facility",e)}set filterFeatures(e){this._callOverride("filterFeatures",e)}set filterLayers(e){this._callOverride("filterLayers",e)}get hasFacilities(){return null!=this.filterLayers?.facilityLayer&&this.filterFeatures?.facilities?.facilitiesInfo?.length>0}get hasLevels(){return null!=this.filterLayers?.levelLayer&&this.filterFeatures?.levels?.levelsInfo?.length>0}get hasMultipleSites(){return null!=this.filterLayers?.siteLayer&&this.filterFeatures?.sites?.sitesInfo?.length>1}get isNormalMode(){let e=!0;const t=this._viewWidthBreakpoint;return"xsmall"!==this._viewHeightBreakpoint&&"xsmall"!==t||(e=!1),e}set level(e){if(!e)return this._callOverride("level",e),this.facility=null,this.site=null,void this.setFloors(null);let t=null,i=null;const s=e?.split("--");if(s?.length>1&&"all"===s[0]?(i=s[1],t={id:e,facilityId:i,shortName:null,longName:null,levelNumber:null,verticalOrder:null}):(t=this.getLevel(e),i=t?.facilityId??null),this.level!==e||this.isNormalMode||this.levelsExpanded)t&&this.hasFacilities&&this.hasLevels?(this.facility=i,this.hasMultipleSites&&(this.site=this.getFacility(i)?.siteId||null),this.setFloors(t)):this._isOverridden("level")&&(this.facility=null,this.site=null,this.hasMultipleSites&&(this.filterMenuType="site"),this.setFloors(null)),this._callOverride("level",e);else{this.getFacilityLevels(i)?.length>1&&(this.levelsExpanded=!0)}}set longNames(e){this._callOverride("longNames",e)}set minimized(e){this._callOverride("minimized",e)}set pinnedLevels(e){this._callOverride("pinnedLevels",e)}set site(e){this._callOverride("site",e)}get state(){return this.view&&this.filterFeatures&&this.hasFacilities&&this.hasLevels?"ready":this.view&&!this.filterFeatures?"loading":"disabled"}filterFacilities(e){let t=e;return this.searchTerm&&(t=e.filter((e=>{const{name:t}=e;return t.toLowerCase().includes(this.searchTerm?.toLowerCase())}))),this.site&&(t=t.filter((e=>e.siteId===this.site))),t.sort(((e,t)=>{const i=e.name,s=t.name;return i>s?1:i===s?0:-1}))}filterSites(e){let t=e;return this.searchTerm&&(t=e.filter((e=>{const{name:t}=e;return t.toLowerCase().includes(this.searchTerm?.toLowerCase())}))),t.sort(((e,t)=>{const i=e.name,s=t.name;return i>s?1:i===s?0:-1}))}getBaseLevel(e){const t=this.filterFeatures?.levels?.levelsInfo;let i=null;if(e){const{id:s}=e;if(t&&t.length>0&&(t.forEach((e=>{0===e.verticalOrder&&e.facilityId===s&&(i=e)})),!i)){let e=null;t.forEach((t=>{t.facilityId===s&&(e?(t.verticalOrder??0)>=0?null!=e.verticalOrder&&(e.verticalOrder<0||(t.verticalOrder??0)<e.verticalOrder)&&(e=t):null!=e.verticalOrder&&null!=t.verticalOrder&&e.verticalOrder<0&&t.verticalOrder>e.verticalOrder&&(e=t):e=t)})),e&&(i=e)}}return i}getFacility(e){return this.filterFeatures?.facilities?.facilitiesInfo?.find((t=>t.id===e))??null}getFacilityLevels(e){return e&&this.filterFeatures?.levels?.levelsInfo?this.filterFeatures.levels.levelsInfo.filter((t=>t.facilityId===e)).sort(((e,t)=>{const i=e.verticalOrder??0,s=t.verticalOrder??0;return i>s?-1:i===s?0:1})):[]}getLevel(e){return this.filterFeatures?.levels?.levelsInfo?.find((t=>t.id===e))??null}getSite(e){return this.filterFeatures?.sites?.sitesInfo?.find((t=>t.id===e))??null}goTo(e){const{view:t}=this;if(!t||!e)return;const{geometry:i}=e;i&&i.extent&&this.callGoTo({target:i.extent,options:{duration:(0,y.HA)(1e3),easing:"in-out-quad"}})}setFloors(e){const{view:t}=this;t&&(t?.map?.allLayers?.forEach((e=>{"feature"===e.type&&this._computeViewAllModeFloors(e)})),t.floors=new p.Z(this._computeFloors(e)))}updateWebDocument(e){if(_(e)){const t=new w.Z({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site??null,facility:this.facility??null,level:this.level??null});e.widgets?e.widgets.floorFilter=t:e.widgets=new g.Z({floorFilter:t})}}_computeFloors(e){if("single-floor"===this.filterMode)this._computeSingleFloor(e);else if("base-floors"===this.filterMode)return"3d"===this.view?.type?this._computeBaseFloors3D(e):this._computeBaseFloors(e);return this._computeEmptyFloors()}_computeSingleFloor(e){if(!e)return this._computeEmptyFloors();const t=[];return"all"===e?.id?this.getFacilityLevels(e.facilityId).forEach((e=>{e.id&&t.push(e.id)})):e&&t.push(e.id),t}_computeBaseFloors(e){const t=this.filterFeatures?.levels?.levelsInfo;if(!t||!t.length)return this._computeEmptyFloors();const i=[];"all"===e?.id?this.getFacilityLevels(e.facilityId).forEach((e=>{e.id&&i.push(e.id)})):e&&i.push(e.id);const s=e?.facilityId;return t.forEach((e=>{const{id:t,facilityId:r,verticalOrder:l}=e;(s||0!==l||i.includes(t))&&(r===s||0!==l||i.includes(t))||i.push(t)})),i}_computeBaseFloors3D(e){const t=this.filterFeatures?.levels?.levelsInfo;if(!t||!t.length)return this._computeEmptyFloors();const i=[],s=e?.id.split("--")??[];s?.length>1&&"all"===s[0]?this.getFacilityLevels(e?.facilityId).forEach((e=>{e.id&&i.push(e.id)})):e&&i.push(e.id);const r=e?.facilityId;return t.forEach((e=>{const{id:t,facilityId:s}=e;(r||i.includes(t))&&(s===r||i.includes(t))||i.push(t)})),i}_computeEmptyFloors(){return[]}async _setFilterLayers(){const{view:e}=this;if(e&&!this._isOverridden("filterLayers")){if(!_(e.map)&&!function(e){return"esri.WebScene"===e.declaredClass}(e.map))throw new v.Z("Map must be a webmap or webscene");{const t=e.map,i=t?.allLayers;if(i?.items?.length>0){const e={siteLayer:null,facilityLayer:null,levelLayer:null},s=t.floorInfo?.siteLayer?.layerId,r=t.floorInfo?.facilityLayer?.layerId,l=t.floorInfo?.levelLayer?.layerId,o=t.floorInfo?.siteLayer?.sublayerId||t.floorInfo?.facilityLayer?.sublayerId||t.floorInfo?.levelLayer?.sublayerId;if(!r||!l)return;const n=i.items.filter((e=>"feature"===e.type||"scene"===e.type)),a=i.items.filter((e=>"map-image"===e.type));if(a?.length>0&&o){await Promise.all(a.map((e=>e.load())));const i=t.floorInfo?.siteLayer?.sublayerId,o=t.floorInfo?.facilityLayer?.sublayerId,n=t.floorInfo?.levelLayer?.sublayerId;a.forEach((t=>{const a=t.id,c=t?.allSublayers,u=c?.items;(a===s||a===r||a===l)&&u?.length>0&&c.items.forEach((t=>{const r=t.id;a===s&&r===i?e.siteLayer=t:r===o?e.facilityLayer=t:r===n&&(e.levelLayer=t)}))}))}n?.length>0&&n.forEach((t=>{const i=t.id;i===s?e.siteLayer=t:i===r?e.facilityLayer=t:i===l&&(e.levelLayer=t)})),this.filterLayers=e}}}}async _getFilterFeatures(){if(this._isOverridden("filterFeatures"))return this.filterFeatures;const[e,t,i]=await Promise.all([this._getSites(),this._getFacilities(),this._getLevels()]);return{sites:e,facilities:t,levels:i}}async _getSites(){const e={sitesInfo:[]},{filterLayers:t,view:i}=this,s=i?.map,{siteLayer:r}=t;if(!r||!s?.floorInfo?.siteLayer)return e;const l=r.createQuery();l.returnGeometry=!0,l.outFields=["*"],l.returnZ=!0,"type"in r&&"scene"===r.type&&(l.multipatchOption="xyFootprint");const{siteIdField:o,nameField:n}=s.floorInfo.siteLayer,a=await r.queryFeatures(l);if(a?.features?.length>0){const t=a.features,i=r?.fieldsIndex.get(o)?.name||o,s=r?.fieldsIndex.get(n)?.name||n;null!=i&&null!=s&&t.forEach((t=>{const r=t.attributes,l=t.geometry,o=r[i],n=r[s];o&&n&&e.sitesInfo.push({id:o,name:n,geometry:l})}))}return e}async _getFacilities(){const{filterLayers:e,view:t}=this,i=t?.map,{facilityLayer:s}=e,r={facilitiesInfo:[]};if(!s||!i?.floorInfo?.facilityLayer)return r;const l=s.createQuery();l.returnGeometry=!0,l.outFields=["*"],l.returnZ=!0,"type"in s&&"scene"===s.type&&(l.multipatchOption="xyFootprint");const{facilityIdField:o,siteIdField:n,nameField:a}=i.floorInfo.facilityLayer,c=await s.queryFeatures(l);if(c?.features?.length>0){const e=c.features,t=s?.fieldsIndex.get(o)?.name||o,i=s?.fieldsIndex.get(n)?.name||n,l=s?.fieldsIndex.get(a)?.name||a;t&&i&&l&&e.forEach((e=>{const s=e.attributes,o=e.geometry,n=s[t],a=s[i],c=s[l];n&&c&&r.facilitiesInfo.push({id:n,siteId:a,name:c,geometry:o})}))}return r}async _getLevels(){const{filterLayers:e,view:t}=this,i=t?.map,{levelLayer:s}=e,r={levelsInfo:[]};if(!s||!i?.floorInfo?.levelLayer)return r;const l=s.createQuery();l.returnGeometry=!0,l.outFields=["*"],l.returnZ=!0;const{levelIdField:o,facilityIdField:n,longNameField:a,shortNameField:c,levelNumberField:u,verticalOrderField:d}=i.floorInfo.levelLayer,h=await s.queryFeatures(l);if(h?.features?.length>0){const e=h.features,t=s?.fieldsIndex.get(o)?.name||o,i=s?.fieldsIndex.get(n)?.name||n,l=s?.fieldsIndex.get(a)?.name||a,p=s?.fieldsIndex.get(c)?.name||c,v=s?.fieldsIndex.get(u)?.name||u,f=s?.fieldsIndex.get(d)?.name||d;t&&i&&l&&p&&v&&f&&e.forEach((e=>{const s=e.attributes,o=s[t],n=s[i],a=s[l],c=s[p],u=s[v],d=s[f];o&&n&&a&&c&&"number"==typeof u&&"number"==typeof d&&r.levelsInfo.push({id:o,facilityId:n,longName:a,shortName:c,levelNumber:u,verticalOrder:d})}))}return r}_registerWidget(e){const t=e?.persistableViewModels.includes(this);t||e?.persistableViewModels.add(this)}_unregisterWidget(e){e?.persistableViewModels.remove(this)}_watchSearchResults(e){e?.on("select-result-floor",(e=>{const t=this.getLevel(e);t&&this.level!==e&&(this.level=e,this.setFloors(t))}))}async _setInitialViewState(e){if(this.view)try{await this.view.when(),await this._setFilterLayers();const t=await this._getFilterFeatures();if(!t)return;if(this.filterFeatures=t,!this.hasFacilities||!this.hasLevels)return void console.error("Facilities and Levels are required for the Floor Filter widget");if(this.hasMultipleSites||(this.filterMenuType="facility"),this.facility&&this.level){this.filterMenuType="facility";const e=this.getFacility(this.facility),t=this.getLevel(this.level);this.site||(this.site=e?.siteId||void 0),this.setFloors(t)}else if(this.facility&&!this.level){this.filterMenuType="facility";const e=this.getFacility(this.facility),t=this.getBaseLevel(e);this.site||(this.site=e?.siteId||void 0),this.level=t?.id||void 0,this.setFloors(t)}else if(!this.facility&&this.level){this.filterMenuType="facility";const e=this.getLevel(this.level),t=this.getFacility(e?.facilityId);this.facility=t?.id||void 0,this.site||(this.site=t?.siteId||void 0),this.setFloors(e)}else if(!this.site||this.facility||this.level){if(!e||!_(e))return void this.setFloors(null);const t=e?.widgets?.floorFilter;if(!t)return void this.setFloors(null);t.site&&!this.site&&(this.site=t.site,this.filterMenuType="facility"),this.setFloors(null)}else this.filterMenuType="site",this.setFloors(null)}catch(u){console.error("Couldn't retrieve sites, facilities, and levels",u)}}_callOverride(e,t){this._override(e,t)}async _updateFloorFilterFromMap(e){if(!e||!_(e))return;const t=e?.widgets?.floorFilter;t&&(this._isOverridden("enabled")||(this.enabled=t.enabled),this._isOverridden("longNames")||(this.longNames=t.longNames),this._isOverridden("minimized")||(this.minimized=t.minimized),this._isOverridden("pinnedLevels")||(this.pinnedLevels=t.pinnedLevels),this._isOverridden("site")||(this.site=t.site),this._isOverridden("facility")||(this.facility=t.facility),this._isOverridden("level")||(this.level=t.level))}_computeViewAllModeFloors(e){const{filterFeatures:t}=this;if(e.floorInfo?.viewAllMode&&this.hasLevels&&this.hasFacilities&&"base-floors"===this.filterMode){const{level:i,facility:s}=this,r=[];t.levels.levelsInfo.forEach((e=>{const{id:t,facilityId:l}=e;s&&l===s?i&&t===i&&r.push(t):r.push(t)})),e.floorInfo.viewAllLevelIds=new p.Z(r)}}};(0,s._)([(0,o.Cb)({value:!1})],I.prototype,"enabled",null),(0,s._)([(0,o.Cb)({value:void 0})],I.prototype,"facility",null),(0,s._)([(0,o.Cb)({value:null})],I.prototype,"filterFeatures",null),(0,s._)([(0,o.Cb)({value:null})],I.prototype,"filterLayers",null),(0,s._)([(0,o.Cb)()],I.prototype,"filterMenuOpen",void 0),(0,s._)([(0,o.Cb)()],I.prototype,"filterMenuType",void 0),(0,s._)([(0,o.Cb)()],I.prototype,"filterMode",void 0),(0,s._)([(0,o.Cb)()],I.prototype,"hasFacilities",null),(0,s._)([(0,o.Cb)()],I.prototype,"hasLevels",null),(0,s._)([(0,o.Cb)()],I.prototype,"hasMultipleSites",null),(0,s._)([(0,o.Cb)({readOnly:!0})],I.prototype,"isNormalMode",null),(0,s._)([(0,o.Cb)({value:void 0})],I.prototype,"level",null),(0,s._)([(0,o.Cb)({value:!1})],I.prototype,"longNames",null),(0,s._)([(0,o.Cb)()],I.prototype,"levelsExpanded",void 0),(0,s._)([(0,o.Cb)({value:!1})],I.prototype,"minimized",null),(0,s._)([(0,o.Cb)({value:!1})],I.prototype,"pinnedLevels",null),(0,s._)([(0,o.Cb)()],I.prototype,"searchTerm",void 0),(0,s._)([(0,o.Cb)({value:void 0})],I.prototype,"site",null),(0,s._)([(0,o.Cb)({readOnly:!0})],I.prototype,"state",null),(0,s._)([(0,o.Cb)()],I.prototype,"view",void 0),(0,s._)([(0,o.Cb)()],I.prototype,"_viewHeightBreakpoint",void 0),(0,s._)([(0,o.Cb)()],I.prototype,"_viewWidthBreakpoint",void 0),(0,s._)([(0,o.Cb)()],I.prototype,"updateWebDocument",null),I=(0,s._)([(0,n.j)("esri/widgets/FloorFilter/FloorFilterViewModel")],I);const M=I;var L=i(28405),F=i(84791),S=i(76558),C=i(61946),A=i(263);const O=["ArrowUp","ArrowDown","End","Home"];let N=class extends a.Z{constructor(e,t){super(e,t),this._activeMenu=null,this._activeMenuIndex={levels:-1,menuItems:-1},this._baseNode=null,this._facilitiesListNode=null,this._levelsListNode=null,this._sitesListNode=null,this._searchInput=null,this.viewModel=new M,this.messages=null,this.messagesCommon=null,this.headingLevel=2,this._resizeObserver=new ResizeObserver((()=>this.scheduleRender())),this.addHandles((0,l.YP)((()=>this._searchInput),(()=>this._focusSearch())))}destroy(){this._resizeObserver?.disconnect()}get enabled(){return this.viewModel.enabled}set enabled(e){this.viewModel.enabled=e}get longNames(){return this.viewModel.longNames}set longNames(e){this.viewModel.longNames=e}get minimized(){return this.viewModel.minimized}set minimized(e){this.viewModel.minimized=e}get pinnedLevels(){return this.viewModel.pinnedLevels}set pinnedLevels(e){this.viewModel.pinnedLevels=e}get site(){return this.viewModel.site}set site(e){this.viewModel.site=e}get facility(){return this.viewModel.facility}set facility(e){this.viewModel.facility=e}get level(){return this.viewModel.level}set level(e){this.viewModel.level=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}updateWebDocument(e){return this.viewModel.updateWebDocument(e)}render(){const{longNames:e}=this,t=e&&this.viewModel.isNormalMode?"expanded":"collapsed",i=this.renderButtons(),s=this.renderFilterMenu(),r=(0,C.u)("div",{class:this.classes(d.separator)}),l=this._getComponentPosition(),o=this._getPosition(l),n="top-right"===l||"bottom-right"===l,a="top-left"===l||"bottom-left"===l,c=(0,F.dZ)(this.container),u=c&&a||!c&&n?s:i,h=c&&a||!c&&n?i:s;return(0,C.u)("div",{afterCreate:this._afterBaseNodeCreate,key:"floor-filter-menu",class:this.classes(d.floorFilter,d.esriWidget,`${d.floorFilterLayout}${t}`,`${d.floorFilterPosition}${o}`)},u,this.viewModel?.filterMenuOpen&&r,h)}renderButtons(){const e=this._getComponentPosition(),t=[];return"top"===this._getPosition(e)?(t.push(this.renderBrowseButton()),t.push(this.renderLevelButtons()),t.push(this.renderCloseLevelsButton()),t.push(this.renderZoomButton()),t.push(this.renderCollapseToggleButton())):(t.push(this.renderCollapseToggleButton()),t.push(this.renderZoomButton()),t.push(this.renderCloseLevelsButton()),t.push(this.renderLevelButtons()),t.push(this.renderBrowseButton())),(0,C.u)("div",{key:"button-container",class:this.classes(d.esriWidget,d.buttonContainer)},t)}renderBrowseButton(){const{longNames:e,messages:t}=this;return(0,C.u)("button",{key:"browse-button",title:t.buttons.browse,bind:this,class:this.classes(d.esriWidget,d.esriWidgetButton,d.esriInteractive,("loading"===this.viewModel.state||"disabled"===this.viewModel.state)&&d.esriButtonDisabled,d.browseButton,this.viewModel?.filterMenuOpen&&d.esriWidgetButtonActive),"aria-expanded":this.viewModel.filterMenuOpen.toString(),"aria-label":t.buttons.browse,onclick:this._toggleFilterMenu,type:"button"},(0,C.u)("div",{class:this.classes(d.buttonInfo)},(0,C.u)("span",{class:this.classes(d.esriIcon,d.urbanIcon)}),(0,C.u)("span",{class:this.classes(d.buttonLabel)},e&&this.viewModel.isNormalMode&&t.buttons.browse)))}renderLevelButtons(){if(!this.viewModel?.filterFeatures?.levels?.levelsInfo||!this.facility)return null;const{facility:e,messagesCommon:t,messages:i}=this,s=this.viewModel?.getFacility(e),r=this.viewModel?.getFacilityLevels(e),l=r.map((e=>this.renderLevelButton(e)));if(!l.length)return null;const o=s&&(0,A.n)(i.selector.levelsLabel,{name:`"${s.name}"`});if(this._isWebScene(this.view?.map)&&l?.length>1){const i={id:`all--${e}`,facilityId:e,shortName:t.all,longName:t.all,levelNumber:null,verticalOrder:null},s=this.renderLevelButton(i);l.push(s)}return(0,C.u)("ul",{key:"levels-button-container",class:this.classes(d.levelsContainer),bind:this,"data-id":"levels",afterCreate:F.Yo,"data-node-ref":"_levelsListNode","aria-label":o,onkeydown:this._handleListKeydown},l)}renderLevelButton(e){const{longNames:t}=this,{shortName:i,longName:s,id:r}=e,l=`levels--${r}`,o=this.level===r,n=t&&this.viewModel.isNormalMode?s:i;return this.viewModel.isNormalMode||o||this.viewModel.levelsExpanded?(0,C.u)("li",{key:l},(0,C.u)("button",{"data-id":r,"data-list-id":"levels",bind:this,class:this.classes(d.esriWidgetButton,o?d.esriWidgetButtonActive:null,d.esriInteractive,d.levelButton),onclick:this._levelSelected,onfocus:this._onItemFocus,type:"button"},n)):null}renderCloseLevelsButton(){if(!this.level||this.viewModel.isNormalMode||!this.viewModel.levelsExpanded)return null;const{messagesCommon:e}=this;return(0,C.u)("button",{key:"close-levels-button",title:e.close,bind:this,class:this.classes(d.esriWidget,d.esriWidgetButton,d.esriInteractive,d.closeLevelsButton),"aria-label":e.close,onclick:this._closeLevels,type:"button"},(0,C.u)("div",{class:this.classes(d.buttonInfo)},(0,C.u)("span",{class:this.classes(d.esriIcon,d.closeIcon)})))}renderZoomButton(){const{longNames:e,messages:t,facility:i,site:s}=this,r=this.viewModel?.filterMenuType,l=this.viewModel?.filterMenuOpen,o=this.viewModel?.getSite(s),n=this.viewModel?.getFacility(i),a="site"===r&&l?!o:!n;return(0,C.u)("button",{key:"zoom-button",title:t.buttons.zoomTo,bind:this,class:this.classes(d.esriWidget,d.esriWidgetButton,a&&d.esriButtonDisabled,d.esriInteractive,this.viewModel?.getFacilityLevels(i).length>0?d.zoomButtonLevels:d.zoomButton),"aria-label":t.buttons.zoomTo,onclick:this._zoomToClicked,type:"button"},(0,C.u)("div",{class:this.classes(d.buttonInfo)},(0,C.u)("span",{class:this.classes(d.esriIcon,d.zoomToIcon)}),(0,C.u)("span",{class:this.classes(d.buttonLabel)},e&&this.viewModel.isNormalMode&&t.buttons.zoomTo)))}renderCollapseToggleButton(){const{longNames:e,messagesCommon:t}=this,i=e?d.collapseIconRight:d.expandIconRight,s=this.classes(d.esriIcon,i),r=e?t.collapse:t.expand;return(0,C.u)("button",{key:"minimize-toggle-button",title:r,bind:this,class:this.classes(d.esriWidget,d.esriWidgetButton,d.esriInteractive,d.minimizeToggleButton),"aria-label":r,onclick:this._toggleCollapsed,type:"button"},(0,C.u)("div",{class:this.classes(d.buttonInfo)},(0,C.u)("span",{class:s}),(0,C.u)("span",{class:this.classes(d.buttonLabel)},e&&this.viewModel.isNormalMode&&t.collapse)))}renderFilterMenu(){return this.viewModel?.filterMenuOpen?"site"===this.viewModel?.filterMenuType?this.renderSiteFilterMenu():"facility"===this.viewModel?.filterMenuType?this.renderFacilityFilterMenu():null:null}renderSiteFilterMenu(){const{messages:e,messagesCommon:t}=this,i=this.site?this.viewModel?.getSite(this.site)?.name:e.selector.selectSite,s=(0,C.u)("div",{key:"filter-menu-site-header",class:this.classes(`${d.filterMenuHeader}`)},(0,C.u)("div",{class:this.classes(d.filterMenuHeaderTextGroup)},(0,C.u)(L.X6,{level:this.headingLevel,class:this.classes(d.filterMenuHeaderText)},i)),(0,C.u)("button",{bind:this,title:t.close,class:this.classes(d.esriIcon,d.closeIcon),onclick:this._closeClicked,type:"button"})),r=this.renderSearchInput(),l=this.renderSiteItems();return(0,C.u)("div",{key:"filter-menu-site",class:this.classes(d.filterMenu)},s,r,l)}renderFacilityFilterMenu(){const{messages:e,messagesCommon:t,site:i}=this,s=this.viewModel?.getSite(i)?.name,r=this.facility&&this.viewModel?.getFacility(this.facility)?.name||e.selector.selectFacility,l=this.viewModel.hasMultipleSites?(0,C.u)("button",{bind:this,title:t.back,class:this.classes(d.filterMenuHeaderBack),onclick:this._backClicked,type:"button"},(0,C.u)("span",{class:this.classes((0,F.dZ)(this.container)?d.rightIcon:d.leftIcon)})):null,o=this.viewModel.hasMultipleSites?(0,C.u)(L.X6,{level:(0,L.MJ)(this.headingLevel),class:this.classes(d.filterMenuHeaderSubtext)},s):null,n=(0,C.u)("div",{key:"filter-menu-site-header",class:this.classes(d.filterMenuHeader)},l,(0,C.u)("div",{class:this.classes(d.filterMenuHeaderTextGroup)},(0,C.u)(L.X6,{level:this.headingLevel,class:this.classes(d.filterMenuHeaderText)},r),o),(0,C.u)("button",{bind:this,title:t.close,class:this.classes(d.esriIcon,d.closeIcon),onclick:this._closeClicked,type:"button"})),a=this.renderSearchInput(),c=this.renderFacilityItems();return(0,C.u)("div",{key:"filter-menu-facility",class:this.classes(d.filterMenu)},n,a,c)}renderSearchInput(){const{messagesCommon:e}=this;return(0,C.u)("div",{key:"filter-menu-search",class:this.classes(d.filterMenuSearch)},(0,C.u)("span",{class:this.classes(d.esriIcon,d.searchIcon)}),(0,C.u)("input",{bind:this,key:"filter-menu-search__input",afterCreate:F.Yo,"data-node-ref":"_searchInput",class:this.classes(d.filterMenuSearchInput),placeholder:e.search,oninput:this._onSearchChange,onpaste:this._onSearchChange,value:this.viewModel.searchTerm??void 0}))}renderBlueCircle(){return(0,C.u)("span",{key:"floor-filter__selected-item-circle",class:this.classes(d.selectedItemCircle)})}renderSiteItems(){if(!this.viewModel?.filterFeatures?.sites?.sitesInfo)return null;const{messages:e}=this,t=this.viewModel.filterFeatures.sites.sitesInfo,i=this.viewModel.filterSites(t).map((e=>this.renderSiteItem(e))),s=0===i.length&&this.viewModel?.searchTerm&&(0,C.u)("div",{class:this.classes(d.esriWidgetContentEmpty)},e.noResults);return(0,C.u)("ul",{key:"filter-menu-items--sites",class:this.classes(d.filterMenuItems),bind:this,afterCreate:F.Yo,"data-node-ref":"_sitesListNode","data-id":"sites",onkeydown:this._handleListKeydown,tabIndex:-1,"aria-label":e.selector.sitesLabel},i,s)}renderSiteItem(e){const{name:t,id:i}=e,s=`filter-menu-site--${i}`,r=this.site===i;return(0,C.u)("li",{key:s},(0,C.u)("button",{"data-id":i,"data-list-id":"sites",bind:this,class:this.classes(d.filterMenuSite),onclick:this._siteSelected,onfocus:this._onItemFocus,type:"button"},r&&this.renderBlueCircle(),(0,C.u)("span",{class:this.classes(r?d.filterMenuSelectedItem:d.filterMenuItemName)},t),(0,C.u)("span",{class:this.classes((0,F.dZ)(this.container)?d.leftIcon:d.rightIcon)})))}renderFacilityItems(){if(!this.viewModel?.filterFeatures?.facilities?.facilitiesInfo)return null;const{messages:e,site:t}=this,i=this.viewModel.getSite(t),s=this.viewModel.filterFeatures.facilities.facilitiesInfo,r=this.viewModel.filterFacilities(s).map((e=>this.renderFacilityItem(e))),l=0===r.length&&this.viewModel?.searchTerm&&(0,C.u)("div",{class:this.classes(d.esriWidgetContentEmpty)},e.noResults),o=i?(0,A.n)(e.selector.siteFacilitiesLabel,{name:`"${i.name}"`}):e.selector.facilitiesLabel;return(0,C.u)("ul",{key:"filter-menu-items--facilities",class:this.classes(d.filterMenuItems),bind:this,afterCreate:F.Yo,"data-node-ref":"_facilitiesListNode","data-id":"facilities",onkeydown:this._handleListKeydown,tabIndex:-1,"aria-label":o},r,l)}renderFacilityItem(e){const{name:t,id:i}=e,s=`filter-menu-facility--${i}`,r=this.facility===i;return(0,C.u)("li",{key:s},(0,C.u)("button",{"data-id":i,"data-list-id":"facilities",bind:this,class:this.classes(d.filterMenuFacility),onclick:this._facilitySelected,onfocus:this._onItemFocus,type:"button"},r&&this.renderBlueCircle(),(0,C.u)("span",{class:this.classes(r?d.filterMenuSelectedItem:d.filterMenuItemName)},t)))}_afterBaseNodeCreate(e){this._baseNode&&this._resizeObserver?.unobserve(this._baseNode),this._baseNode=e,this._resizeObserver?.observe(this._baseNode)}_toggleCollapsed(){this.longNames=!this.longNames}_toggleFilterMenu(){const e=this.viewModel?.filterMenuOpen??!1;this.viewModel.filterMenuOpen=!e}_setFilterMenuType(e){this.viewModel.filterMenuType=e}_zoomToClicked(){if(this.site&&"site"===this.viewModel?.filterMenuType&&this.viewModel?.filterMenuOpen){const e=this.viewModel?.getSite(this.site);this.viewModel.goTo(e)}else if(this.facility){const e=this.viewModel?.getFacility(this.facility);this.viewModel.goTo(e)}else if(this.site){const e=this.viewModel?.getSite(this.site);this.viewModel.goTo(e)}}_onSearchChange(e){const t=e.target;""===t.value?this.viewModel.searchTerm=null:t.value&&this.viewModel?.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value.toLowerCase().trim())}_closeClicked(){this.viewModel.searchTerm=null,this.viewModel.filterMenuOpen=!1}_backClicked(){this._setFilterMenuType("site"),this.viewModel.searchTerm=null}_siteSelected(e){const t=e.currentTarget.getAttribute("data-id"),i=this.viewModel.getSite(t);let s=!1;this.site!==t&&(this.facility=null,this.level=null,s=!0,this.viewModel.levelsExpanded=!1),this.site=t,this.viewModel.searchTerm=null,this._setFilterMenuType("facility"),this.viewModel.goTo(i),s&&this.viewModel.setFloors(null)}_facilitySelected(e){const t=e.currentTarget.getAttribute("data-id"),i=this.viewModel.getFacility(t);let s=!1;if(this.facility!==t){if("base-floors"===this.viewModel.filterMode){const e=this.viewModel?.getBaseLevel(i);this.level=e?e.id:null}else this.level=null;s=!0,this.viewModel.levelsExpanded=!1}if(this.facility=t,this.viewModel.goTo(i),s){const e=this.viewModel.getLevel(this.level);this.viewModel.setFloors(e)}if(!this.viewModel.isNormalMode){this.viewModel.getFacilityLevels(t)?.length>1&&(this.viewModel.levelsExpanded=!0)}setTimeout((()=>this._focusActiveLevel()),50)}_levelSelected(e){const t=e.currentTarget.getAttribute("data-id");this.level=t}_closeLevels(){this.viewModel.levelsExpanded=!1}_isWebScene(e){return"esri.WebScene"===e?.declaredClass}_getComponentPosition(){return null!=this.container?this.view?.ui?.getPosition(this.container):null}_getPosition(e){switch(e){case"bottom-right":case"bottom-left":return"bottom";default:return"top"}}_handleListKeydown(e){const t=e.currentTarget.getAttribute("data-id");let i=null;"sites"===t||"facilities"===t?(this._activeMenu!==t&&(this._activeMenuIndex.menuItems=-1),this._activeMenu=t,i="menuItems"):"levels"===t&&(i="levels");const s="sites"===t?this._sitesListNode:"facilities"===t?this._facilitiesListNode:"levels"===t?this._levelsListNode:null,l=(0,r.kK)(e),o="Tab"===l,n=O.includes(l);n&&e.preventDefault();const a=s?.getElementsByTagName("li");a&&0!==a.length&&(n||o)&&this._handleItemNavigation(l,e.shiftKey,a,o,i)}_handleItemNavigation(e,t,i,s,r){if(!r)return;this._activeMenuIndex[r]===i.length&&this._activeMenuIndex[r]--,-1===this._activeMenuIndex[r]&&this._activeMenuIndex[r]++;const l=this._activeMenuIndex[r];switch(e){case"Home":this._activeMenuIndex[r]=0;break;case"End":this._activeMenuIndex[r]=i.length-1;break;case"ArrowUp":this._activeMenuIndex[r]=this._activeMenuIndex[r]<=0?i.length-1:this._activeMenuIndex[r]-1;break;case"ArrowDown":this._activeMenuIndex[r]=this._activeMenuIndex[r]===i.length-1?0:this._activeMenuIndex[r]+1}if("Tab"===e&&t&&this._activeMenuIndex[r]>=0&&this._activeMenuIndex[r]--,"Tab"===e&&!t&&this._activeMenuIndex[r]<i.length&&this._activeMenuIndex[r]++,l!==this._activeMenuIndex[r]&&this._activeMenuIndex[r]>-1&&this._activeMenuIndex[r]<i.length&&!s){const e=i[this._activeMenuIndex[r]].getElementsByTagName("button");(1===e?.length?e[0]:null)?.focus()}}_focusSearch(){this._searchInput?.focus()}_focusActiveLevel(){const{level:e}=this,t=this._levelsListNode,i=t?.getElementsByTagName("li");if(!e||!t||!i)return;const s=this._facilitiesListNode?.getElementsByTagName("li");this._activeMenuIndex.menuItems=s?s.length-1:-1;const r=[];for(let l=0;l<i.length;l++){const e=i[l].getElementsByTagName("button");1===e?.length&&r.push(e[0])}r.forEach(((t,i)=>{t.getAttribute("data-id")===e&&(t.focus(),this._activeMenuIndex.levels=i)}))}_onItemFocus(e){const t=e.currentTarget,i=t.getAttribute("data-list-id"),s=t.getAttribute("data-id"),r="sites"===i?this._sitesListNode:"facilities"===i?this._facilitiesListNode:"levels"===i?this._levelsListNode:null;if(!r)return;const l=r?.getElementsByTagName("li");if(!l)return;const o=[];Array.from(l).forEach((e=>{const t=e.getElementsByTagName("button");1===t?.length&&o.push(t[0])}));let n=null;switch(i){case"sites":case"facilities":n="menuItems";break;case"levels":n="levels"}if(!n)return;const a=n;o.forEach(((e,t)=>{e.getAttribute("data-id")===s&&this._activeMenuIndex[a]!==t&&(this._activeMenuIndex[a]=t)}))}};(0,s._)([(0,o.Cb)()],N.prototype,"_searchInput",void 0),(0,s._)([(0,o.Cb)()],N.prototype,"enabled",null),(0,s._)([(0,o.Cb)()],N.prototype,"longNames",null),(0,s._)([(0,o.Cb)()],N.prototype,"minimized",null),(0,s._)([(0,o.Cb)()],N.prototype,"pinnedLevels",null),(0,s._)([(0,o.Cb)()],N.prototype,"site",null),(0,s._)([(0,o.Cb)()],N.prototype,"facility",null),(0,s._)([(0,o.Cb)()],N.prototype,"level",null),(0,s._)([(0,o.Cb)()],N.prototype,"view",null),(0,s._)([(0,o.Cb)({type:M})],N.prototype,"viewModel",void 0),(0,s._)([(0,o.Cb)(),(0,S.H)("esri/widgets/FloorFilter/t9n/FloorFilter")],N.prototype,"messages",void 0),(0,s._)([(0,o.Cb)(),(0,S.H)("esri/t9n/common")],N.prototype,"messagesCommon",void 0),(0,s._)([(0,o.Cb)()],N.prototype,"goToOverride",null),(0,s._)([(0,o.Cb)()],N.prototype,"headingLevel",void 0),N=(0,s._)([(0,n.j)("esri.widgets.FloorFilter")],N);const T=N}}]);